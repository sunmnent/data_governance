(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([[62],{"1kgF":function(e,t,a){"use strict";var l=a("tAuX"),d=a("g09b");Object.defineProperty(t,"__esModule",{value:!0}),t.default=void 0,a("g9YV");var n=d(a("wCAj"));a("+L6B");var s=d(a("2/Rp"));a("y8nQ");var r=d(a("Vl3Y"));a("5NDa");var u=d(a("5rEg"));a("miYZ");var i=d(a("tsqr")),o=d(a("p0pE"));a("Pwec");var c=d(a("CtXQ")),f=d(a("2Taf")),m=d(a("vZ4D")),p=d(a("l4Ni")),h=d(a("ujKo")),g=d(a("rlhR")),y=d(a("MhPg"));a("2qtc");var b=d(a("kLXV")),v=l(a("q1tI")),D=a("LvDl"),S=a("Nmln"),E=d(a("pktp"));a("P7b5");var C=b.default.confirm,I=function(e){function t(e){var a;return(0,f.default)(this,t),a=(0,p.default)(this,(0,h.default)(t).call(this,e)),a.columns=[{title:"\u7cfb\u7edf\u540d\u79f0",dataIndex:"name"},{title:"\u7cfb\u7edf\u7f16\u7801",dataIndex:"code"},{title:"\u6240\u5c5e\u90e8\u95e8",dataIndex:"deptName"},{title:"\u8d23\u4efb\u4eba",dataIndex:"userName"},{title:"\u66f4\u65b0\u65f6\u95f4",dataIndex:"modifyTime",sorter:!0},{title:"\u5907\u6ce8",dataIndex:"notes"},{title:"\u64cd\u4f5c",dataIndex:"tags",render:function(e,t){return v.default.createElement("div",null,v.default.createElement(c.default,{type:"edit",className:"can-click",style:{marginRight:10},onClick:a.showAddModal.bind((0,g.default)(a),t)}),v.default.createElement(c.default,{type:"delete",className:"can-click",onClick:a.deleteSys.bind((0,g.default)(a),t)}))}}],a.getListData=function(){(0,S.QuerySystemPageParam)(a.state.params).then(function(e){var t={},l=[];e&&e.success&&e.obj&&(t=e.obj,e.obj.list&&(l=e.obj.list)),a.setState({systemData:t,systemList:l})})},a.getDeptmentData=function(){(0,S.DeptCatagoryQueryDept)({}).then(function(e){var t=[];e&&e.success&&e.obj&&(t=e.obj[0].children),a.setState({deptData:t})})},a.getUseData=function(){(0,S.SourceSystemUser)({}).then(function(e){var t=[];e&&e.success&&e.obj&&(t=e.obj),a.setState({userData:t})})},a.getSelectedCard=function(e,t,l,d){a.setState({currentId:l,selectedArray:e,selectedIdsArray:t,selected:d})},a.showAddModal=function(e){a.setState({visible:!0,modalData:e})},a.onCancel=function(){a.setState({visible:!1,modalData:{}})},a.onSubmit=function(e){a.setState({addLoading:!0});var t,l=(0,o.default)({},e,{deptId:parseInt(e.deptId),userId:parseInt(e.userId)});a.state.modalData.id?(l.id=a.state.modalData.id,t=S.SourceSystemUpdate):t=S.SourceSystemAdd,t(l).then(function(e){e&&(e.success?a.setState({addLoading:!1,visible:!1},function(){i.default.success("\u6dfb\u52a0\u6210\u529f"),a.getListData()}):(a.setState({addLoading:!1}),i.default.error(e.msg)))})},a.deleteSys=function(e){C({title:"\u63d0\u793a\u4fe1\u606f",content:"\u60a8\u786e\u5b9a\u8981\u5220\u9664\u7cfb\u7edf\u540d\u79f0\u4e3a\u3010".concat(e.name,"\u3011\u7684\u6570\u636e\u5417\uff1f"),cancelText:"\u53d6\u6d88",okText:"\u786e\u5b9a",onOk:function(){(0,S.SourceSystemDel)({id:e.id}).then(function(e){e&&(e.success?(i.default.success("\u5220\u9664\u6210\u529f"),a.getListData()):i.default.error(e.msg))})}})},a.changePage=function(e,t,l){var d=(0,o.default)({},a.state.params,{pageNum:e.current});l.order&&(d.order=l.order.slice(0,-3),d.orderBy=(0,D.snakeCase)(l.columnKey)),a.setState({params:d},function(){a.getListData()})},a.handleSubmit=function(){a.props.form.validateFields(function(e,t){if(!e){var l=(0,o.default)({},a.state.params,t,{pageNum:1});a.setState({params:l},function(){a.getListData()})}})},a.state={selectedArray:[],selectedIdsArray:[],selected:!1,systemData:{},systemList:[],currentId:"",deptData:[],userData:[],addLoading:!1,visible:!1,params:{pageNum:1,pageSize:10},modalData:{}},a}return(0,y.default)(t,e),(0,m.default)(t,[{key:"componentDidMount",value:function(){this.getListData(),this.getDeptmentData(),this.getUseData()}},{key:"render",value:function(){var e=this.state,t=(e.selectedArray,e.modalData),a=e.systemList,l=e.systemData,d=e.deptData,i=e.userData,o=e.visible,c=e.addLoading,f=this.state.params,m=f.pageNum,p=f.pageSize,h=this.props.form.getFieldDecorator,g={current:m,pageSize:p,total:(0,D.isEmpty)(l)?0:l.total,showQuickJumper:!0};return v.default.createElement("div",null,v.default.createElement(r.default,{layout:"inline",onSubmit:this.handleSubmit,style:{marginBottom:10}},v.default.createElement(r.default.Item,{label:"\u7cfb\u7edf\u540d\u79f0"},h("systemName",{})(v.default.createElement(u.default,{placeholder:"\u7cfb\u7edf\u540d\u79f0"}))),v.default.createElement(r.default.Item,null,v.default.createElement(s.default,{type:"primary",htmlType:"submit"},"\u641c\u7d22"),v.default.createElement(s.default,{type:"primary",onClick:this.showAddModal.bind(this,{}),style:{marginLeft:20}},"\u65b0\u5efa"))),v.default.createElement(n.default,{columns:this.columns,dataSource:a,pagination:g,onChange:this.changePage,rowKey:"id"}),v.default.createElement(E.default,{visible:o,isAdd:!t.id,onCancel:this.onCancel,onSubmit:this.onSubmit,userData:i,addLoading:c,deptData:d,editData:t}))}}]),t}(v.Component),L=r.default.create()(I);t.default=L},P7b5:function(e,t,a){},pktp:function(e,t,a){"use strict";var l=a("g09b"),d=a("tAuX");Object.defineProperty(t,"__esModule",{value:!0}),t.default=void 0,a("2qtc");var n=l(a("kLXV"));a("+L6B");var s=l(a("2/Rp")),r=l(a("jehZ")),u=l(a("2Taf")),i=l(a("vZ4D")),o=l(a("l4Ni")),c=l(a("ujKo")),f=l(a("MhPg"));a("OaEy");var m=l(a("2fM7"));a("5NDa");var p=l(a("5rEg"));a("y8nQ");var h,g,y,b=l(a("Vl3Y")),v=d(a("q1tI")),D=l(a("Jt6A")),S=a("LvDl");a("P7b5");var E=b.default.Item,C=p.default.TextArea,I=m.default.Option,L={labelCol:{span:5},wrapperCol:{span:19}},k=(h=b.default.create(),h((y=function(e){function t(e){var a;return(0,u.default)(this,t),a=(0,o.default)(this,(0,c.default)(t).call(this,e)),a.handleSubmit=function(e){e.preventDefault(),a.props.form.validateFieldsAndScroll(function(e,t){e||a.props.onSubmit&&a.props.onSubmit(t)})},a.handleCancel=function(){a.props.onCancel&&a.props.onCancel()},a.handelReset=function(){a.props.form.resetFields()},a.state={},a}return(0,f.default)(t,e),(0,i.default)(t,[{key:"render",value:function(){var e=[],t=this.props,a=t.visible,l=t.addLoading,d=t.editData,u=t.isAdd,i=t.userData,o=t.deptData,c=this.props.form.getFieldDecorator;return(0,S.isEmpty)(i)||i.forEach(function(t){e.push(v.default.createElement(I,{key:t.id,value:t.id},t.nameCn))}),v.default.createElement(n.default,{title:u?"\u65b0\u5efa\u7cfb\u7edf":"\u7f16\u8f91\u7cfb\u7edf",visible:a,onCancel:this.handleCancel,footer:null,destroyOnClose:!0,className:"source_system_modal",maskClosable:!1},v.default.createElement(b.default,{layout:"horizontal",onSubmit:this.handleSubmit},v.default.createElement(E,(0,r.default)({},L,{label:"\u540d\u79f0"}),c("name",{rules:[{required:!0,message:"\u8bf7\u8f93\u5165\u540d\u79f0"}],initialValue:u?"":d.name})(v.default.createElement(p.default,{placeholder:"\u8bf7\u8f93\u5165\u540d\u79f0",disabled:!u}))),v.default.createElement(E,(0,r.default)({},L,{label:"\u7cfb\u7edf\u7f16\u7801"}),c("code",{rules:[{required:!0,message:"\u8bf7\u8f93\u5165\u7cfb\u7edf\u7f16\u7801"},{pattern:/^([A-Z]){4}$/,message:"\u8bf7\u8f93\u5165\u56db\u4f4d\u5927\u5199\u5b57\u6bcd\u7cfb\u7edf\u7f16\u7801"}],initialValue:u?"":d.code})(v.default.createElement(p.default,{placeholder:"\u8bf7\u8f93\u5165\u56db\u4f4d\u5927\u5199\u5b57\u6bcd\u7cfb\u7edf\u7f16\u7801",disabled:!(u||!d.code)}))),v.default.createElement(E,(0,r.default)({},L,{label:"\u8d23\u4efb\u4eba"}),c("userId",{rules:[{required:!0,message:"\u8bf7\u9009\u62e9\u8d23\u4efb\u4eba"}],initialValue:u?null:d.userId})(v.default.createElement(m.default,{placeholder:"\u8bf7\u9009\u62e9\u8d23\u4efb\u4eba"},e))),v.default.createElement(E,(0,r.default)({},L,{label:"\u8d23\u4efb\u90e8\u95e8"}),c("deptId",{rules:[{required:!0,message:"\u8d23\u4efb\u90e8\u95e8\u4e0d\u80fd\u4e3a\u7a7a"}],initialValue:u?"":d.deptId})(v.default.createElement(D.default,{showSearch:!0,defaultValueItem:"nodeCode",option:o,disabled:!0}))),v.default.createElement(E,(0,r.default)({},L,{label:"\u5907\u6ce8"}),c("notes",{rules:[{required:!1,message:"\u8bf7\u8f93\u5165\u5907\u6ce8"}],initialValue:u?"":d.notes})(v.default.createElement(C,{style:{minHeight:32},placeholder:"\u8bf7\u8f93\u5165\u5907\u6ce8\u4fe1\u606f",rows:4}))),v.default.createElement(E,(0,r.default)({},L,{className:"ssm_btn"}),v.default.createElement(s.default,{type:"primary",htmlType:"submit",loading:l,style:{marginLeft:"15px"}},"\u4fdd\u5b58"),v.default.createElement(s.default,{type:"ghost",onClick:this.handelReset,style:{marginLeft:"15px"}},"\u91cd\u7f6e"),u?"":v.default.createElement(s.default,{onClick:this.handleCancel,style:{marginLeft:"15px"}},"\u53d6\u6d88\u4fee\u6539"))))}}]),t}(v.Component),g=y))||g);t.default=k}}]);