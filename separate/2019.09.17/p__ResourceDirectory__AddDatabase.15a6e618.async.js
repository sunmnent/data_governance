(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([[48],{Chv6:function(e,t,a){"use strict";var l=a("g09b"),i=a("tAuX");Object.defineProperty(t,"__esModule",{value:!0}),t.default=void 0,a("+L6B");var r=l(a("2/Rp"));a("sRBo");var s=l(a("kaz8"));a("giR+");var d=l(a("fyUT"));a("5NDa");var n=l(a("5rEg"));a("7Kak");var u=l(a("9yH6"));a("OaEy");var c=l(a("2fM7"));a("y8nQ");var o,p,f,h=l(a("Vl3Y")),m=i(a("q1tI")),y=a("MuoO"),g=(l(a("Jt6A")),a("7DNP")),b=a("ATFn"),v=l(a("MpEX")),E=h.default.Item,N=c.default.Option,S=u.default.Group,D=n.default.TextArea,I=(o=(0,y.connect)(e=>{var t=e.resourceDirectory,a=e.tagMange,l=e.cachedData;return{resourceDirectory:t,tagMange:a,cachedData:l}}),o((f=class extends m.Component{constructor(){super(...arguments),this.handleSubmit=((e,t)=>{this.props.form.validateFieldsAndScroll((a,l)=>{a||(e&&(l.submitState=t),l.isAuth=l.isAuth?1:0,this.props.next(l,e))})}),this.blurTableName=(e=>{var t=this.props.form,a=t.setFieldsValue,l=t.getFieldValue,i=t.validateFields;if(l("tableName")){var r=l("tableName").toUpperCase();a({tableName:r}),i(["tableName"])}}),this.changeFileType=(e=>{var t=this.props.form.setFieldsValue;"N"===e&&t({isLogTable:"N",isIncriease:"N"})}),this.changeLogTable=(e=>{var t=this.props.form.setFieldsValue;t({isIncriease:e.target.value})}),this.changeMultiFlag=(e=>{var t=this.props.form.setFieldsValue;"M"===e&&t({fileType:"N",isIncriease:"N"})}),this.reload=(()=>{var e=this.props.form,t=e.setFieldsValue,a=e.getFieldValue;setTimeout(()=>{"N"===a("fileType")&&t({isIncriease:"N"})},0)}),this.goBack=(()=>{this.props.dispatch(g.routerRedux.goBack())}),this.filterOption=((e,t)=>t.props.children.toLowerCase().indexOf(e.toLowerCase())>=0)}render(){var e=this.props.form,t=e.getFieldDecorator,a=e.getFieldValue,l=this.props.resourceDirectory,i=l.fileTypeObj,o=l.multiFlagObj,p=l.resourceTypeObj,f=l.systemList,y=l.secondCatagory,g=this.props.tagMange.tags,I=this.props,k=I.value,T=I.saveBtn,V=I.type,O="1"===V,C="0"!==T,F=!C||O,x=(e,t,a)=>{t&&!t.match(b.ENGLISH_CHART)&&a("\u8bf7\u8f93\u5165\u4ee5\u82f1\u6587\u5f00\u5934\u7684\u82f1\u6587\u540d"),a()};return m.default.createElement(h.default,{className:v.default.basicInformation},m.default.createElement(E,{label:"\u8d44\u6e90\u540d\u79f0"},t("tableName",{initialValue:k.tableName,rules:[{required:!0,message:"\u8bf7\u8f93\u5165\u8d44\u6e90\u540d\u79f0"},{max:20,message:"\u6700\u591a20\u4e2a\u5b57\u7b26"},{validator:x}]})(m.default.createElement(n.default,{disabled:F,onBlur:this.blurTableName,placeholder:"\u8bf7\u8f93\u5165\u8d44\u6e90\u540d\u79f0"}))),m.default.createElement(E,{label:"\u4e2d\u6587\u540d\u79f0"},t("tableNameCn",{initialValue:k.tableNameCn,rules:[{required:!0,message:"\u8bf7\u8f93\u5165\u4e2d\u6587\u540d\u79f0"}]})(m.default.createElement(n.default,{placeholder:"\u8bf7\u8f93\u5165\u4e2d\u6587\u540d\u79f0"}))),m.default.createElement(E,{label:"\u5f62\u6001"},t("resourceType",{initialValue:k.resourceType||"D",rules:[{required:!0,message:"\u8bf7\u9009\u62e9\u5f62\u6001"}]})(m.default.createElement(c.default,{disabled:F,placeholder:"\u8bf7\u9009\u62e9\u5f62\u6001",onChange:this.reload},Object.entries(p).map(e=>m.default.createElement(N,{value:e[1],key:e[0]},e[0]))))),m.default.createElement(E,{label:"\u6e90\u7cfb\u7edf"},t("busSystemId",{initialValue:k.busSystemId||f[0]&&f[0].id,rules:[{required:!0,message:"\u8bf7\u9009\u62e9\u6e90\u7cfb\u7edf"}]})(m.default.createElement(c.default,{disabled:F,placeholder:"\u8bf7\u9009\u62e9\u6e90\u7cfb\u7edf",showSearch:!0,optionFilterProp:"children"},f.map(e=>m.default.createElement(N,{value:e.id,key:e.id},e.name))))),m.default.createElement(E,{label:"\u4e3b\u9898"},t("classifyId",{initialValue:k.classifyId,rules:[{required:!0,message:"\u8bf7\u9009\u62e9\u4e3b\u9898"}]})(m.default.createElement(c.default,{placeholder:"\u8bf7\u9009\u62e9\u4e3b\u9898"},y.map(e=>m.default.createElement(N,{value:e.id,key:e.id},e.name))))),m.default.createElement(E,{label:"\u6d41\u6c34\u8868\u6807\u8bc6"},t("isLogTable",{initialValue:k.isLogTable||"N",rules:[{required:!0,message:"\u8bf7\u9009\u62e9\u6d41\u6c34\u8868\u6807\u8bc6"}]})(m.default.createElement(S,{disabled:"F"===a("resourceType")&&"S"!==a("fileType"),onChange:this.changeLogTable},m.default.createElement(u.default,{value:"Y"},"\u6d41\u6c34\u8868"),m.default.createElement(u.default,{value:"N"},"\u975e\u6d41\u6c34\u8868")))),m.default.createElement(E,{label:"\u662f\u5426\u589e\u91cf"},t("isIncriease",{initialValue:k.isIncriease||"N",rules:[{required:!0,message:"\u8bf7\u9009\u62e9\u662f\u5426\u589e\u91cf"}]})(m.default.createElement(S,{disabled:"Y"===a("isLogTable")||"N"===a("fileType")},m.default.createElement(u.default,{value:"Y"},"\u589e\u91cf"),m.default.createElement(u.default,{value:"N"},"\u5168\u91cf")))),"Y"===a("isIncriease")&&m.default.createElement(m.Fragment,null,m.default.createElement(E,{label:"\u589e\u91cf\u6761\u4ef6"},t("increaseParam",{initialValue:k.increaseParam})(m.default.createElement(n.default,{placeholder:"\u8bf7\u8f93\u5165\u589e\u91cf\u6761\u4ef6"}))),m.default.createElement(E,{label:"\u589e\u91cf\u521d\u59cb\u503c"},t("increaseInitValue",{initialValue:k.increaseInitValue})(m.default.createElement(d.default,{placeholder:"\u8bf7\u8f93\u5165\u589e\u91cf\u521d\u59cb\u503c"})))),"F"===a("resourceType")&&m.default.createElement("div",null,m.default.createElement(E,{label:"\u590d\u5408\u8d44\u6e90\u6807\u8bc6"},t("multiFlag",{initialValue:k.multiFlag||"M",rules:[{required:!0,message:"\u8bf7\u9009\u62e9\u590d\u5408\u8d44\u6e90\u6807\u8bc6"}]})(m.default.createElement(c.default,{disabled:F,placeholder:"\u8bf7\u9009\u62e9\u590d\u5408\u8d44\u6e90\u6807\u8bc6",onChange:this.changeMultiFlag},Object.entries(o).map(e=>m.default.createElement(N,{value:e[1],key:e[0]},e[0]))))),m.default.createElement(E,{label:"\u6587\u4ef6\u7c7b\u578b"},t("fileType",{initialValue:k.fileType||"N",rules:[{required:!0,message:"\u8bf7\u9009\u62e9\u6587\u4ef6\u7c7b\u578b"}]})(m.default.createElement(c.default,{placeholder:"\u8bf7\u9009\u62e9\u6587\u4ef6\u7c7b\u578b",disabled:"M"===a("multiFlag")||F,onChange:this.changeFileType},Object.entries(i).map(e=>m.default.createElement(N,{value:e[1],key:e[0]},e[0])))))),m.default.createElement(E,{label:"\u6807\u7b7e"},t("tagIds",{initialValue:k.tagIds||k.tagList&&k.tagList.map(e=>e.id)})(m.default.createElement(c.default,{mode:"multiple",placeholder:"\u8bf7\u9009\u62e9\u6807\u7b7e",filterOption:this.filterOption},g.map(e=>m.default.createElement(N,{value:e.id,key:e.id},e.tagName))))),m.default.createElement(E,{label:"\u8d44\u6e90\u63cf\u8ff0"},t("tableDesc",{initialValue:k.tableDesc})(m.default.createElement(D,{rows:4,placeholder:"\u8bf7\u8f93\u5165\u8d44\u6e90\u63cf\u8ff0"}))),m.default.createElement(E,{label:" ",colon:!1},t("isAuth",{valuePropName:"checked",initialValue:k.isAuth})(m.default.createElement(s.default,{disabled:F},"\u662f\u5426\u6709\u6761\u4ef6\u5171\u4eab\uff08\u6b64\u8d44\u6e90\u9700\u8981\u901a\u8fc7\u63d0\u4f9b\u65b9\u5ba1\u6838\uff0c\u4f7f\u7528\u65b9\u65b9\u53ef\u4f7f\u7528\uff09"))),m.default.createElement(E,null,m.default.createElement("div",{className:v.default.action},m.default.createElement(r.default,{onClick:this.goBack,className:v.default.marginRight},"\u53d6\u6d88"),"N"===a("fileType")?m.default.createElement("span",null,O?m.default.createElement(r.default,{type:"primary",onClick:this.handleSubmit.bind(this,!0,1),className:v.default.marginRight},"\u4fdd\u5b58\u5e76\u9a73\u56de"):m.default.createElement(m.Fragment,null,C&&m.default.createElement(r.default,{type:"primary",onClick:this.handleSubmit.bind(this,!0,1),className:v.default.marginRight},"\u4fdd\u5b58"),m.default.createElement(r.default,{type:"primary",onClick:this.handleSubmit.bind(this,!0,2)},"\u63d0\u4ea4"))):m.default.createElement(r.default,{type:"primary",onClick:this.handleSubmit.bind(this,!1)},"\u4e0b\u4e00\u6b65"))))}},p=f))||p),k=h.default.create()(I);t.default=k},O043:function(e,t,a){"use strict";var l=a("g09b"),i=a("tAuX");Object.defineProperty(t,"__esModule",{value:!0}),t.default=void 0,a("T2oS");var r=l(a("W9HT")),s=l(a("Y/ft")),d=l(a("p0pE"));a("FJo9");var n,u,c,o=l(a("L41K")),p=i(a("q1tI")),f=a("MuoO"),h=l(a("Qyje")),m=l(a("Chv6")),y=l(a("X2kM")),g=l(a("MpEX")),b=o.default.Step,v=(n=(0,f.connect)(e=>{var t=e.resourceDirectory,a=e.cachedData,l=e.tagMange,i=e.sunmStandard,r=e.loading;return{resourceDirectory:t,cachedData:a,tagMange:l,sunmStandard:i,loading:r}}),n((c=class extends p.Component{constructor(){super(...arguments),this.state={current:0,value:{},operationState:{}},this.next=((e,t)=>{var a=this.state,l=a.value,i=a.current,r=this.props.resourceDirectory,n=r.idItem,u=(r.systemList,h.default.parse(this.props.location.search.slice(1))),c=u.id,o=(0,d.default)({},l,{[i]:e});if(o[1]=o[1]||{},o[1].items=o[1].items||[],0!==i||t){var p=h.default.parse(this.props.location.search.slice(1)),f=p.id,m=o[1].items.map(e=>{if(!e.isOld){e.id;var t=(0,s.default)(e,["id"]);return t}return e});f&&(m=m.filter(e=>3!==e.status)),this.props.dispatch({type:"resourceDirectory/saveResource",payload:(0,d.default)({id:f},o[0],o[1],{items:m})})}else c||this.added||(n.forEach(e=>{o[1].items.find(t=>t.dataItemId===e.id)||(o[1].items.find(e=>e.isPk)||(e.isPk=!0,e.isNullAble="N"),o[1].items.unshift(e))}),this.added=!0),this.setState({current:i+1,value:o})}),this.prev=(e=>{var t=this.state,a=t.value,l=t.current;this.setState({value:(0,d.default)({},a,{[l]:e}),current:l-1})}),this.changeOperationState=(e=>{this.setState({operationState:e})})}componentDidMount(){var e=this.props.resourceDirectory,t=e.fileTypeObj,a=e.multiFlagObj,l=e.resourceTypeObj,i=e.systemList,r=e.encyptList,s=e.idItem,d=e.secondCatagory,n=this.props.cachedData.dataItemCatagory;Object.keys(t).length||this.props.dispatch({type:"resourceDirectory/getFileTypeObj"}),Object.keys(a).length||this.props.dispatch({type:"resourceDirectory/getMultiFlagObj"}),Object.keys(l).length||this.props.dispatch({type:"resourceDirectory/getResourceTypeObj"}),Object.keys(r).length||this.props.dispatch({type:"resourceDirectory/getEncyptList"}),i.length||this.props.dispatch({type:"resourceDirectory/getSystemList"}),d.length||this.props.dispatch({type:"resourceDirectory/queurySecondCatagory"}),n.length||this.props.dispatch({type:"cachedData/getDataItemCatagory"}),s.length||this.props.dispatch({type:"resourceDirectory/getIDItem"}),this.props.tagMange.tags.length||this.props.dispatch({type:"tagMange/getAllTag"});var u=h.default.parse(this.props.location.search.slice(1)),c=u.id;c&&Promise.all([this.props.dispatch({type:"resourceDirectory/getResourceDetail",payload:c}),this.props.dispatch({type:"resourceDirectory/getDataItems",payload:{id:c}})]).then(e=>{e[1]&&e[1].forEach(e=>{e.isOld=!0}),this.setState({value:{0:e[0],1:{items:e[1],fileUrl:e[0].fileUrl,fileName:e[0].fileName}}},()=>{this.setState({reloadUI:1})})});var o=this.props.sunmStandard.fieldType;o.length||this.props.dispatch({type:"sunmStandard/fetchFieldType"})}render(){var e=this.state,t=e.current,a=e.value,l=e.operationState,i=h.default.parse(this.props.location.search.slice(1)),s=i.id,d=i.type,n=i.saveBtn,u=!0===this.props.loading.effects["resourceDirectory/getResourceDetail"],c=[{title:"\u57fa\u672c\u4fe1\u606f",content:p.default.createElement(m.default,{next:this.next,value:a["0"]||{},id:s,type:d,saveBtn:n})},{title:"\u6570\u636e\u7ed3\u6784",content:p.default.createElement(y.default,{prev:this.prev,next:this.next,value:a["1"]||{},id:s,type:d,saveBtn:n,operationState:l,changeOperationState:this.changeOperationState})}];return p.default.createElement(r.default,{spinning:u},p.default.createElement("h1",{className:g.default.title},s?"\u7f16\u8f91":"\u65b0\u5efa","\u8d44\u6e90"),p.default.createElement(o.default,{current:t,className:g.default.steps},c.map(e=>p.default.createElement(b,{key:e.title,title:e.title}))),p.default.createElement("div",null,c[t].content))}},u=c))||u),E=v;t.default=E},X2kM:function(e,t,a){"use strict";var l=a("g09b"),i=a("tAuX");Object.defineProperty(t,"__esModule",{value:!0}),t.default=void 0,a("DZo9");var r=l(a("8z0m"));a("g9YV");var s=l(a("wCAj"));a("+L6B");var d=l(a("2/Rp"));a("miYZ");var n=l(a("tsqr")),u=l(a("p0pE"));a("P2fV");var c=l(a("NJEC"));a("Pwec");var o=l(a("CtXQ")),p=l(a("qIgq"));a("giR+");var f=l(a("fyUT"));a("5NDa");var h=l(a("5rEg"));a("y8nQ");var m=l(a("Vl3Y"));a("OaEy");var y,g,b,v=l(a("2fM7")),E=i(a("q1tI")),N=a("MuoO"),S=l(a("LvDl")),D=a("7DNP"),I=a("Wvwx"),k=l(a("RSsB")),T=a("qxfp"),V=l(a("MpEX")),O=v.default.Option,C=m.default.Item,F=(e,t,a)=>{!t||new RegExp(/^[a-z]+$/i).test(t[0])?!t||new RegExp(/^\w+$/).test(t)?a():a("\u53ea\u80fd\u7531\u6570\u5b57\u3001\u5b57\u6bcd\u3001\u4e0b\u5212\u7ebf\u7ec4\u6210"):a("\u53ea\u80fd\u4ee5\u5b57\u6bcd\u5f00\u5934")},x={Y:"\u662f",N:"\u5426"},M=(y=(0,N.connect)(e=>{var t=e.resourceDirectory,a=e.sunmStandard;return{resourceDirectory:t,sunmStandard:a}}),y((b=class extends E.default.Component{constructor(){var e;super(...arguments),e=this,this.state={data:this.props.value.items||[],fileUrl:this.props.value.fileUrl,fileName:this.props.value.fileName,modalVisible:!1,preEditedData:[]},this.renderInput2=((e,t,a,l)=>{var i=this.props.form,r=i.getFieldDecorator,s=i.getFieldValue,d=this.props.resourceDirectory.encyptList,n=this.isDisabled(a);if("remark"===e)return E.default.createElement(C,null,r("".concat(e,"-").concat(a.id),{initialValue:t})(E.default.createElement(h.default,{disabled:n})));if(!this.isEdit(a)){if("isNullAble"===e)return x[t];if("isPk"===e){if(!0===t)return"\u662f";if(!1===t)return"\u5426"}if("isEncypt"===e){var u=Object.entries(d).find(e=>e[1]==t);return u&&u[0]}return t}if("chineseName"===e)return E.default.createElement(C,null,r("".concat(e,"-").concat(a.id),{initialValue:t,rules:[{required:!0,message:"\u8bf7\u8f93\u5165"}]})(E.default.createElement(h.default,{disabled:n,onChange:this.changeChineseName.bind(this,a)})));if("dataItemName"===e)return E.default.createElement(C,null,r("".concat(e,"-").concat(a.id),{initialValue:t,rules:[{required:!0,message:"\u8bf7\u8f93\u5165"},{validator:F}]})(E.default.createElement(h.default,{disabled:n})));if("dataTypeName"===e){var c=this.props.sunmStandard.fieldType;return E.default.createElement(C,null,r("".concat(e,"-").concat(a.id),{initialValue:t,rules:[{required:!0,message:"\u8bf7\u9009\u62e9"}]})(E.default.createElement(v.default,{disabled:n,style:{width:90},onChange:this.changeDataType.bind(this,a)},c.map(e=>E.default.createElement(O,{value:e.title,key:e.title},e.title)))))}if("length"===e){var o=s("dataTypeName-".concat(a.id)),m=["\u5b57\u7b26\u578b","\u6d6e\u70b9\u578b","\u65f6\u95f4\u578b"].includes(o);return E.default.createElement(C,null,r("".concat(e,"-").concat(a.id),{initialValue:t,rules:[{required:m,message:"\u8bf7\u8f93\u5165"}]})(E.default.createElement(f.default,{disabled:n,min:1,max:4e3,style:{width:55}})))}if("percision"===e){var y=s("dataTypeName-".concat(a.id)),g="\u6d6e\u70b9\u578b"===y||"\u5e01\u503c\u578b"===y;return E.default.createElement(C,null,r("".concat(e,"-").concat(a.id),{initialValue:t,rules:[{required:g,message:"\u8bf7\u8f93\u5165"}]})(E.default.createElement(f.default,{disabled:!g,min:0,max:255,style:{width:55}})))}if("isNullAble"===e){var b=s("isPk-".concat(a.id));return E.default.createElement(C,null,r("".concat(e,"-").concat(a.id),{initialValue:t||"Y",rules:[{required:!0,message:"\u8bf7\u9009\u62e9"}]})(E.default.createElement(v.default,{disabled:b||n},Object.entries(x).map(e=>{var t=(0,p.default)(e,2),a=t[0],l=t[1];return E.default.createElement(O,{value:a,key:a},l)}))))}return"isPk"===e?E.default.createElement(C,null,r("".concat(e,"-").concat(a.id),{initialValue:t||!1,rules:[{required:!0,message:"\u8bf7\u9009\u62e9"}]})(E.default.createElement(v.default,{disabled:n,onChange:this.changePk.bind(this,a)},E.default.createElement(O,{value:!0},"\u662f"),E.default.createElement(O,{value:!1},"\u5426")))):"isEncypt"===e?E.default.createElement(C,null,r("".concat(e,"-").concat(a.id),{initialValue:t||1,rules:[{required:!0,message:"\u8bf7\u9009\u62e9"}]})(E.default.createElement(v.default,{disabled:n},Object.entries(d).map(e=>E.default.createElement(O,{value:e[1],key:e[1]},e[0]))))):E.default.createElement(C,null,r("".concat(e,"-").concat(a.id),{initialValue:t,rules:[{required:!0,message:"\u8bf7\u8f93\u5165"}]})(E.default.createElement(h.default,{disabled:n})))}),this.columns=(()=>{var e=[{title:"\u4e2d\u6587\u7b80\u79f0",dataIndex:"chineseName",render:this.renderInput2.bind(this,"chineseName")},{title:"\u6570\u636e\u9879\u540d",dataIndex:"dataItemName",render:this.renderInput2.bind(this,"dataItemName")},{title:"\u7c7b\u578b",dataIndex:"dataTypeName",render:this.renderInput2.bind(this,"dataTypeName")},{title:"\u957f\u5ea6",dataIndex:"length",render:this.renderInput2.bind(this,"length")},{title:"\u7cbe\u5ea6",dataIndex:"percision",render:this.renderInput2.bind(this,"percision")},{title:"\u662f\u5426\u4e3a\u7a7a",dataIndex:"isNullAble",render:this.renderInput2.bind(this,"isNullAble")},{title:"\u662f\u5426\u4e3b\u952e",dataIndex:"isPk",render:this.renderInput2.bind(this,"isPk")},{title:"\u5b89\u5168\u9009\u9879",dataIndex:"isEncypt",render:this.renderInput2.bind(this,"isEncypt")},{title:"\u4e1a\u52a1\u5b9a\u4e49\u53ca\u89c4\u5219",dataIndex:"businessDefinition",render:this.renderInput2.bind(this,"businessDefinition")},{title:"\u64cd\u4f5c",dataIndex:"operation",render:(e,t,a)=>{var l=this.isDisabled(t);if(!l)return E.default.createElement("div",null,this.isEdit(t)?E.default.createElement("span",null,E.default.createElement(o.default,{type:"save",className:"can-click",style:{marginRight:10},title:"\u4fdd\u5b58",onClick:this.save.bind(this,t)}),t.chineseName&&E.default.createElement(o.default,{type:"rest",className:"can-click",style:{marginRight:10},title:"\u53d6\u6d88\u4fdd\u5b58",onClick:this.cancelSave.bind(this,t)})):E.default.createElement(o.default,{type:"edit",className:"can-click",style:{marginRight:10},title:"\u7f16\u8f91",onClick:this.edit.bind(this,[t])}),E.default.createElement(c.default,{title:"\u786e\u5b9a\u5220\u9664\uff1f",onConfirm:this.delete.bind(this,t,a)},E.default.createElement(o.default,{type:"delete",className:"can-click",title:"\u5220\u9664"})))}}];"1"===this.props.type?e.splice(11,0,{title:"\u4fee\u6539\u5907\u6ce8",dataIndex:"remark",render:this.renderInput2.bind(this,"remark")}):"2"===this.props.type&&e.splice(11,0,{title:"\u4fee\u6539\u5907\u6ce8",dataIndex:"remark"},{title:"\u4fee\u6539\u72b6\u6001",dataIndex:"operationState",render:e=>{return 0===e?"\u5220\u9664":1===e?"\u65b0\u589e":2===e?"\u4fee\u6539":void 0}});var t=this.props.id,a=this.state.data.some(e=>[1,2,3].includes(e.status));return t&&a&&e.unshift({title:"",dataIndex:"status",render:e=>E.default.createElement("span",null,1===e&&E.default.createElement(o.default,{type:"plus"}),2===e&&E.default.createElement(o.default,{type:"edit"}),3===e&&E.default.createElement(o.default,{type:"minus"}))}),e})(),this.isDisabled=(e=>this.props.id&&3===e.status),this.delete=((e,t)=>{if("1"===this.props.type&&e.dataItemId)void 0===this.props.operationState[e.id]?(this.props.changeOperationState((0,u.default)({},this.props.operationState,{[e.id]:0})),document.querySelectorAll(".ant-table-tbody tr")[t].classList.add(V.default.delete)):n.default.error("\u7f16\u8f91\u8fc7\u7684\u6570\u636e\u9879\u4e0d\u80fd\u5220\u9664");else{var a=this.state.data.filter(t=>t.id!==e.id);this.setState({data:a})}}),this.changeChineseName=((e,t)=>{this.props.form.setFieldsValue({["dataItemName-".concat(e.id)]:(0,I.getChart)(t.target.value.trim())})}),this.changeDataType=(e=>{this.props.form.setFieldsValue({["percision-".concat(e.id)]:void 0})}),this.changePk=((e,t)=>{t&&this.props.form.setFieldsValue({["isNullAble-".concat(e.id)]:"N"})}),this.handleSubmit=((e,t)=>{this.props.form.validateFields((a,l)=>{if(!a){var i=S.default.cloneDeep(this.state.data);if(Object.keys(l).length>1)return void n.default.warning("\u8fd8\u6709\u6570\u636e\u9879\u6ca1\u6709\u64cd\u4f5c\u7ed3\u675f");var r=!0,s=!1,d=void 0;try{for(var u,c=i[Symbol.iterator]();!(r=(u=c.next()).done);r=!0){var o=u.value;if(3!==o.dataItemState&&!o.businessDefinition)return void n.default.warn("\u8bf7\u586b\u5199\u4e1a\u52a1\u5b9a\u4e49\u53ca\u89c4\u5219")}}catch(a){s=!0,d=a}finally{try{r||null==c.return||c.return()}finally{if(s)throw d}}"1"===this.props.type?Object.entries(this.props.operationState).forEach(e=>{var t=i.find(t=>String(t.id)===e[0]);t&&(t.operationState=e[1])}):"2"===this.props.type&&(i=i.filter(e=>0!==e.operationState),i.forEach(e=>{e.remark=null,e.operationState=null})),e({fileUrl:this.state.fileUrl,fileName:this.state.fileName,items:i,submitState:t})}})}),this.showModal=(()=>{this.setState({modalVisible:!0})}),this.hideModal=(()=>{this.setState({modalVisible:!1})}),this.addData=((e,t)=>{if(this.setState({data:[...this.state.data,...e]}),t&&this.edit(e),"1"===this.props.type){var a=(0,u.default)({},this.props.operationState);e.forEach(e=>{a[e.id]=1}),this.props.changeOperationState(a)}}),this.edit=(e=>{this.setState({preEditedData:[...this.state.preEditedData,...e]})}),this.cancelEdit=(e=>{var t=this.state.preEditedData.filter(t=>t.id!==e.id);this.setState({preEditedData:t})}),this.isEdit=(e=>this.state.preEditedData.some(t=>t.id===e.id)),this.save=(t=>{var a=this.getValidateFields(t);this.props.form.validateFields(a.map(e=>e[0]),(l,i)=>{if(!l){var r={},s=!0,d=!1,n=void 0;try{for(var c,o=function(){var t=c.value;h=(0,p.default)(t,2);var a=h[0],l=h[1],i=a.split("-");if(r[i[0]]=l,"dataTypeName"===i[0]){var s=e.props.sunmStandard.fieldType,d=s.find(e=>e.title===l);r.dataType=d?d.value:void 0}},f=a[Symbol.iterator]();!(s=(c=f.next()).done);s=!0){var h;o()}}catch(l){d=!0,n=l}finally{try{s||null==f.return||f.return()}finally{if(d)throw n}}var m=[...this.state.data],y=m.findIndex(e=>e.id===t.id);m[y]=(0,u.default)({},m[y],r),this.setState({data:m}),this.cancelEdit(t)}})}),this.cancelSave=(e=>{this.cancelEdit(e)}),this.getValidateFields=(e=>{var t=this.props.form.getFieldsValue(),a=Object.entries(t).filter(t=>{var a=(0,p.default)(t,1),l=a[0],i=l.split("-");return 2===i.length&&i[1]==e.id});return a}),this.add=(()=>{var e=Date.now();this.addData([{id:e,dataItemState:0}],!0)}),this.goBack=(()=>{this.props.dispatch(D.routerRedux.goBack())})}componentDidMount(){this.state.data.forEach((e,t)=>{0===this.props.operationState[e.id]&&document.querySelectorAll(".ant-table-tbody tr")[t].classList.add(V.default.delete)})}render(){var e=this.state,t=e.modalVisible,a=e.data,l=e.fileUrl,i=e.fileName,u=this.props.form.getFieldDecorator,c=this.props,p=c.id,f=c.type,h=c.saveBtn,y="".concat(T.BASE_URL,"/tableModelResource/uploadFile?token=").concat((0,T.TOKEN)());p&&(y+="&resourceId=".concat(p));var g={name:"file",action:y,onRemove:e=>{this.setState({fileUrl:"",fileName:""})},beforeUpload:e=>{var t=new FormData;return t.append("file",e),fetch(y,{method:"POST",body:t}).then(e=>e.json()).then(e=>{e.success?(this.setState({fileUrl:e.obj.fileUrl,fileName:e.obj.fileName}),n.default.success("\u6587\u4ef6\u4e0a\u4f20\u6210\u529f")):n.default.error(e.msg)}),!1},fileList:i?[{uid:"1",name:i,status:"done",url:"".concat(T.BASE_URL,"/tableModelResource/downloadFile?token=").concat((0,T.TOKEN)(),"&fileName=").concat(i,"&fileUrl=").concat(l)}]:[]},b="1"===f,v="0"!==h;return E.default.createElement("div",{className:V.default.tableStructure},E.default.createElement(d.default,{type:"primary",onClick:this.showModal,className:V.default.marginRight},E.default.createElement(o.default,{type:"plus"}),"\u9009\u62e9"),E.default.createElement(d.default,{type:"primary",onClick:this.add},E.default.createElement(o.default,{type:"plus"}),"\u65b0\u589e"),E.default.createElement(m.default,{layout:"inline"},E.default.createElement(s.default,{bordered:!0,dataSource:this.state.data,columns:this.columns,pagination:!1,className:V.default.table,rowKey:"id"}),E.default.createElement(C,{label:"\u9644\u4ef6\u8bc1\u660e",extra:"10\u6761\u4ee5\u4e0a\u6570\u636e\u6837\u4f8b\u6216\u6570\u636e\u5e93\u5b57\u6bb5\u8bf4\u660e\u6587\u4ef6..."},u("fileUrl",{})(E.default.createElement(r.default,g,E.default.createElement(d.default,null,E.default.createElement(o.default,{type:"upload"})," \u4e0a\u4f20\u6587\u4ef6"))))),E.default.createElement("div",{className:V.default.action},E.default.createElement(d.default,{onClick:this.goBack,className:V.default.marginRight},"\u53d6\u6d88"),E.default.createElement(d.default,{onClick:this.handleSubmit.bind(this,this.props.prev),className:V.default.marginRight},"\u4e0a\u4e00\u6b65"),b?E.default.createElement(d.default,{type:"primary",onClick:this.handleSubmit.bind(this,this.props.next,1),className:V.default.marginRight},"\u4fdd\u5b58\u5e76\u9a73\u56de"):E.default.createElement(E.Fragment,null,v&&E.default.createElement(d.default,{type:"primary",onClick:this.handleSubmit.bind(this,this.props.next,1),className:V.default.marginRight},"\u4fdd\u5b58"),E.default.createElement(d.default,{type:"primary",onClick:this.handleSubmit.bind(this,this.props.next,2)},"\u63d0\u4ea4"))),E.default.createElement(k.default,{addData:this.addData,existData:a,modalVisible:t,hideModal:this.hideModal}))}},g=b))||g),j=m.default.create({onValuesChange:(e,t,a)=>{if("1"===e.type){var l=Object.entries(t)[0][0].split("-"),i=(0,p.default)(l,2),r=i[0],s=i[1];void 0===e.operationState[s]&&"remark"!==r&&e.changeOperationState((0,u.default)({},e.operationState,{[s]:2}))}}})(M);t.default=j}}]);