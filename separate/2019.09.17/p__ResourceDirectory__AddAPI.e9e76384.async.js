(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([[47],{"2GDt":function(e,t,a){"use strict";var l=a("g09b"),s=a("tAuX");Object.defineProperty(t,"__esModule",{value:!0}),t.default=void 0,a("T2oS");var r=l(a("W9HT")),i=l(a("Y/ft")),n=l(a("p0pE"));a("FJo9");var d,u,o,c=l(a("L41K")),h=s(a("q1tI")),m=a("MuoO"),f=l(a("WPgq")),p=l(a("7oMl")),y=l(a("Qyje")),g=l(a("MpEX")),v=c.default.Step,E=(d=(0,m.connect)(e=>{var t=e.resourceDirectory,a=e.cachedData,l=e.tagMange,s=e.sunmStandard,r=e.loading;return{resourceDirectory:t,cachedData:a,tagMange:l,sunmStandard:s,loading:r}}),d((o=class extends h.Component{constructor(){super(...arguments),this.state={current:0,value:{}},this.next=((e,t)=>{var a=this.state,l=a.value,s=a.current,r=this.props.resourceDirectory,d=r.idItem,u=(r.systemList,y.default.parse(this.props.location.search.slice(1))),o=u.id,c=(0,n.default)({},l,{[s]:e});if(c[1]=c[1]||{},c[1].items=c[1].items||[],0!==s||t){var h=y.default.parse(this.props.location.search.slice(1)),m=h.id,f=[];c[1].items.forEach(e=>{if(e.isOld)f.push(e);else{e.id;var t=(0,i.default)(e,["id"]);f.push(t)}}),this.props.dispatch({type:"resourceDirectory/saveResource",payload:(0,n.default)({id:m},c[0],c[1],{items:f})})}else o||this.added||(d.forEach(e=>{c[1].items.find(t=>t.dataItemId===e.id)||(c[1].items.find(e=>e.isPk)||(e.isPk=!0,e.isNullAble="N"),c[1].items.unshift(e))}),this.added=!0),this.setState({current:s+1,value:c})}),this.prev=(e=>{var t=this.state,a=t.value,l=t.current;this.setState({value:(0,n.default)({},a,{[l]:e}),current:l-1})})}componentDidMount(){var e=this.props.resourceDirectory,t=(e.fileTypeObj,e.multiFlagObj,e.resourceTypeObj,e.systemList),a=(e.encyptList,e.idItem,e.secondCatagory);this.props.cachedData.dataItemCatagory;t.length||this.props.dispatch({type:"resourceDirectory/getSystemList"}),a.length||this.props.dispatch({type:"resourceDirectory/queurySecondCatagory"})}render(){var e=this.state,t=e.current,a=e.value,l=y.default.parse(this.props.location.search.slice(1)),s=l.id,i=l.type,n=!0===this.props.loading.effects["resourceDirectory/getResourceDetail"],d=[{title:"\u57fa\u672c\u4fe1\u606f",content:h.default.createElement(f.default,{next:this.next,value:a["0"]||{},id:s})},{title:"\u670d\u52a1\u4fe1\u606f",content:h.default.createElement(p.default,{prev:this.prev,next:this.next,value:a["1"]||{},id:s,type:i})}];return h.default.createElement(r.default,{spinning:n},h.default.createElement("h1",{className:g.default.title},s?"\u7f16\u8f91":"\u65b0\u5efa","API"),h.default.createElement(c.default,{current:t,className:g.default.steps},d.map(e=>h.default.createElement(v,{key:e.title,title:e.title}))),h.default.createElement("div",null,d[t].content))}},u=o))||u),C=E;t.default=C},"7oMl":function(e,t,a){"use strict";var l=a("g09b"),s=a("tAuX");Object.defineProperty(t,"__esModule",{value:!0}),t.default=void 0,a("/zsF");var r=l(a("PArb"));a("+L6B");var i=l(a("2/Rp"));a("5NDa");var n=l(a("5rEg")),d=l(a("jehZ"));a("miYZ");var u=l(a("tsqr")),o=l(a("p0pE")),c=l(a("jHYr"));a("y8nQ");var h=l(a("Vl3Y"));a("FJo9");var m=l(a("L41K"));a("7Kak");var f=l(a("9yH6"));a("OaEy");var p,y,g,v,E=l(a("2fM7")),C=s(a("q1tI")),b=a("MuoO"),N=a("7DNP"),D=a("LvDl"),S=l(a("vk7a")),k=l(a("gykn")),_=l(a("fym6")),w=E.default.Option,R=f.default.Group,T=(m.default.Step,{labelCol:{span:5},wrapperCol:{span:19}});function I(e){for(var t="",a=0;a<e.length;a++)e.charCodeAt(a)>65248&&e.charCodeAt(a)<65375?t+=String.fromCharCode(e.charCodeAt(a)-65248):t+=String.fromCharCode(e.charCodeAt(a));return t}var F=(p=h.default.create(),y=(0,b.connect)(e=>{return(0,c.default)(e),{resourceInfo:{},themeFormsData:{},patternFormsData:{},systemData:{},formParamsData:{},submitting:!1}}),p(g=y((v=class extends C.default.PureComponent{constructor(e){super(e),this.onValidateForm=(e=>{var t=this.props,a=t.form,l=t.dispatch,s=t.resourceInfo,r=this.props.formParamsData,i=this.state,n=i.userId,d=i.newServiceCode;a.validateFields((t,a)=>{if(!t){var i=(0,D.cloneDeep)(a);if(i.userId=n,i.isAuth=a.isAuth?1:2,i.resourceAlias=I(i.resourceAlias),"next"===e){var c={resourceAlias:i.resourceAlias,sysId:i.sysId,userId:i.userId};"true"===sessionStorage.isNewResource&&delete c.userId,l({type:"addResource/checkResourceAlias",payload:c}).then(e=>{e.success?(r=(0,o.default)({},r,i),"admin"===localStorage.authority?r.operate=1:r.operate=2,r.serviceFlag=d,"true"===sessionStorage.isNewResource?(r.isSubmit=1,l({type:"addResource/addResourceForm",payload:r}).then(e=>{e.success?(u.default.success(e.msg),l(N.routerRedux.push("/maintain")),sessionStorage.resourceId=""):u.default.error(e.msg)})):"true"===sessionStorage.isUpdateResource?(r.resourceId=sessionStorage.resourceId,l({type:"addResource/resourceUpdate",payload:r}).then(e=>{e.success?(u.default.success(e.msg),l(N.routerRedux.push("/maintain")),sessionStorage.resourceId="",sessionStorage.removeItem("isUpdateResource")):u.default.error(e.msg)})):(r.status=s.resource.status,r.isSubmit=1,r.resourceId=sessionStorage.resourceId,l({type:"addResource/editResourceForm",payload:r}).then(e=>{e.success?(u.default.success(e.msg),l(N.routerRedux.push("/maintain")),sessionStorage.resourceId=""):u.default.error(e.msg)}))):u.default.error(e.msg)})}}})}),this.changeSystem=((e,t)=>{this.setState({userId:t.props.userid}),this.props.form.setFieldsValue({userName:t.props.username})}),this.onChangeAttachment=(e=>{console.log(e);var t=e.fileList;if(t=t.slice(-1),"uploading"!==e.file.status&&(!e.file.response.success||-1===e.file.response.errorCode))return u.default.error("".concat(e.file.response.msg)),void this.setState({attachmentFileList:[]});"done"===e.file.status?(u.default.success("".concat(e.file.name," \u4e0a\u4f20\u6210\u529f")),this.props.dispatch({type:"addResource/setFileName",payload:e.file.name})):"error"===e.file.status&&u.default.error("".concat(e.file.name," \u4e0a\u4f20\u5931\u8d25")),this.setState({attachmentFileList:t})}),this.newServiceCode=(()=>{this.setState(e=>{var t=e.newServiceCode;return{newServiceCode:!t}})}),this.onChangeRequest=(()=>{}),this.onChangeRespond=(()=>{});this.props.resourceInfo;this.state={userId:void 0,attachmentFileList:[],newServiceCode:!1},this.resourceId=sessionStorage.resourceId}render(){var e=this.props,t=e.form,a=e.themeFormsData,l=e.patternFormsData,s=e.systemData,u=e.resourceInfo,o=this.state,c=o.attachmentFileList,m=(o.newServiceCode,t.getFieldDecorator),p=u.resource,y=void 0===p?{}:p,g=[];(0,D.isEmpty)(a)||a.forEach(e=>{g.push(C.default.createElement(w,{key:e.id},e.name))});var v=[];(0,D.isEmpty)(l)||l.forEach(e=>{"\u6d88\u606f"===e.name&&e.id+"",v.push(C.default.createElement(w,{key:e.id},e.name))});var E=[];(0,D.isEmpty)(s)||(0,D.isEmpty)(s.rows)||s.rows.forEach(e=>{E.push(C.default.createElement(w,{key:e.id,userid:e.userId,username:e.userName},e.sysName))});localStorage.token,this.onChangeAttachment;return C.default.createElement(C.Fragment,null,C.default.createElement(h.default,{layout:"horizontal",className:_.default.form,hideRequiredMark:!0,style:{width:650}},C.default.createElement("div",{className:_.default.title2},"\u670d\u52a1\u4fe1\u606f"),C.default.createElement(h.default.Item,(0,d.default)({},T,{label:"\u53d1\u5e03\u65b9\u5f0f"}),m("resourceAlias",{initialValue:1})(C.default.createElement(R,null,C.default.createElement(f.default,{value:1},"http"),C.default.createElement(f.default,{value:2},"webService")))),C.default.createElement(h.default.Item,(0,d.default)({},T,{label:"\u8bf7\u6c42\u65b9\u5f0f"}),m("resourceTitle",{initialValue:1})(C.default.createElement(R,null,C.default.createElement(f.default,{value:1},"get"),C.default.createElement(f.default,{value:2},"post")))),C.default.createElement(h.default.Item,(0,d.default)({},T,{label:"\u670d\u52a1url"}),m("sysId",{initialValue:y.sysId})(C.default.createElement(C.Fragment,null,C.default.createElement(n.default,{style:{width:"60%"}}),C.default.createElement(i.default,{type:"primary",style:{marginLeft:5}},"\u6d4b\u8bd5URL")))),C.default.createElement(r.default,null),C.default.createElement("div",{className:_.default.title2},"\u8bf7\u6c42\u53c2\u6570\u8bf4\u660e"),C.default.createElement(S.default,{onChange:this.onChangeRequest}),C.default.createElement("div",{className:_.default.title2},"\u8fd4\u56de\u53c2\u6570\u8bf4\u660e"),C.default.createElement(k.default,{onChange:this.onChangeRespond}),C.default.createElement("div",{className:_.default.action},C.default.createElement(i.default,{onClick:this.props.prev,className:_.default.marginRight},"\u4e0a\u4e00\u6b65"),C.default.createElement(i.default,{type:"primary",onClick:()=>{this.props.dispatch(N.routerRedux.push("/resourceDirectory/publish/maintain"))},loading:this.props.submitting},"\u63d0\u4ea4"))))}},g=v))||g)||g);t.default=F},SH8r:function(e,t,a){e.exports={stepForm:"stepForm___1Yzgp",selectedButton:"selectedButton___1pKCp",data_type:"data_type___39sYM",stepThree:"stepThree___2SKiq",stepThreeButton:"stepThreeButton___2WONo",firstButton:"firstButton___3_Yy9",searchRow:"searchRow___2uvlU",modalCol:"modalCol___yuNTZ",action:"action___2R1e6",upload:"upload___1dMfR",download:"download___HCqVu",attachmentWrap:"attachmentWrap___P4OuO",attachment:"attachment___1y_Df",newServiceCode:"newServiceCode___3o24S",jdbcUrl:"jdbcUrl___2cbjj"}},WPgq:function(e,t,a){"use strict";var l=a("g09b"),s=a("tAuX");Object.defineProperty(t,"__esModule",{value:!0}),t.default=void 0,a("T2oS");var r=l(a("W9HT"));a("DZo9");var i=l(a("8z0m"));a("+L6B");var n=l(a("2/Rp"));a("Pwec");var d=l(a("CtXQ"));a("sRBo");var u=l(a("kaz8"));a("miYZ");var o=l(a("tsqr")),c=l(a("p0pE"));a("5NDa");var h=l(a("5rEg"));a("OaEy");var m=l(a("2fM7"));a("y8nQ");var f,p,y,g=l(a("Vl3Y")),v=s(a("q1tI")),E=a("MuoO"),C=l(a("fym6")),b=(l(a("Jt6A")),a("qxfp")),N=(l(a("Qyje")),a("7DNP")),D=a("ATFn"),S=g.default.Item,k=m.default.Option,_=h.default.TextArea,w=(f=(0,E.connect)(e=>{var t=e.resourceDirectory,a=e.cachedData,l=e.loading;return{resourceDirectory:t,cachedData:a,loading:l}}),f((y=class extends v.Component{constructor(){super(...arguments),this.state={value:{}},this.blurTableName=(e=>{var t=this.props.form,a=t.setFieldsValue,l=t.getFieldValue,s=t.validateFields;if(l("tableName")){var r=l("tableName").toUpperCase();a({tableName:r}),s(["tableName"])}}),this.changeSystem=(e=>{var t=this.props.form.setFieldsValue,a=this.props.resourceDirectory.systemList.find(t=>t.id===e);t({responsible:a&&a.account&&a.account.username})}),this.handleSubmit=(e=>{this.props.form.validateFieldsAndScroll((t,a)=>{if(!t){a.isAuth=a.isAuth?1:0,a.resourceType="M",a.fileUrl=this.state.value.fileUrl,a.fileName=this.state.value.fileName,delete a.responsible;var l=this.props.id;this.props.dispatch({type:"resourceDirectory/saveResource",payload:(0,c.default)({id:l,submitState:e},a)})}})}),this.goBack=(()=>{this.props.dispatch(N.routerRedux.goBack())})}componentDidMount(){var e=this.props.resourceDirectory,t=(e.systemList,e.secondCatagory,this.props.id);t&&this.props.dispatch({type:"resourceDirectory/getResourceDetail",payload:t}).then(e=>{this.setState({value:e}),this.changeSystem(e.busSystemId)})}render(){var e=this.props.form.getFieldDecorator,t=this.props.resourceDirectory,a=t.systemList,l=t.secondCatagory,s=!0===this.props.loading.effects["resourceDirectory/getResourceDetail"],f=this.state.value,p=this.props.id,y="".concat(b.BASE_URL,"/tableModelResource/uploadFile?token=").concat((0,b.TOKEN)());p&&(y+="&resourceId=".concat(p));var E={name:"file",action:y,onRemove:e=>{this.setState({value:(0,c.default)({},this.state.value,{fileUrl:"",fileName:""})})},beforeUpload:e=>{var t=new FormData;return t.append("file",e),fetch(y,{method:"POST",body:t}).then(e=>e.json()).then(e=>{e.success?(this.setState({value:(0,c.default)({},this.state.value,{fileUrl:e.obj.fileUrl,fileName:e.obj.fileName})}),o.default.success("\u6587\u4ef6\u4e0a\u4f20\u6210\u529f")):o.default.error(e.msg)}),!1},fileList:f.fileName?[{uid:"1",name:f.fileName,status:"done",url:"".concat(b.BASE_URL,"/tableModelResource/downloadFile?token=").concat((0,b.TOKEN)(),"&fileUrl=").concat(f.fileUrl,"&fileName=").concat(f.fileName)}]:[]},N=(e,t,a)=>{t&&!t.match(D.ENGLISH_CHART)&&a("\u8bf7\u8f93\u5165\u4ee5\u82f1\u6587\u5f00\u5934\u7684\u82f1\u6587\u540d"),a()};return v.default.createElement(r.default,{spinning:s},v.default.createElement(g.default,{className:C.default.form},v.default.createElement(S,{label:"\u8d44\u6e90\u540d\u79f0"},e("tableName",{initialValue:f.tableName,rules:[{required:!0,message:"\u8bf7\u8f93\u5165\u8d44\u6e90\u540d\u79f0"},{max:20,message:"\u6700\u591a20\u4e2a\u5b57\u7b26"},{validator:N}]})(v.default.createElement(h.default,{onBlur:this.blurTableName,placeholder:"\u8bf7\u8f93\u5165\u8d44\u6e90\u540d\u79f0"}))),v.default.createElement(S,{label:"\u4e2d\u6587\u63cf\u8ff0"},e("tableNameCn",{initialValue:f.tableNameCn,rules:[{required:!0,message:"\u8bf7\u8f93\u5165\u4e2d\u6587\u63cf\u8ff0"}]})(v.default.createElement(h.default,{placeholder:"\u8bf7\u8f93\u5165\u4e2d\u6587\u63cf\u8ff0"}))),v.default.createElement(S,{label:"\u6e90\u7cfb\u7edf"},e("busSystemId",{initialValue:f.busSystemId||a[0]&&a[0].id,rules:[{required:!0,message:"\u8bf7\u9009\u62e9\u6e90\u7cfb\u7edf"}]})(v.default.createElement(m.default,{placeholder:"\u8bf7\u9009\u62e9\u6e90\u7cfb\u7edf",onChange:this.changeSystem,showSearch:!0,optionFilterProp:"children"},a.map(e=>v.default.createElement(k,{value:e.id,key:e.id},e.name))))),v.default.createElement(S,{label:"\u8d23\u4efb\u4eba"},e("responsible",{initialValue:a[0]&&a[0].account&&a[0].account.username,rules:[{required:!0,message:"\u8bf7\u9009\u62e9\u8d23\u4efb\u4eba"}]})(v.default.createElement(h.default,{disabled:!0}))),v.default.createElement(S,{label:"\u4e3b\u9898"},e("classifyId",{initialValue:f.classifyId,rules:[{required:!0,message:"\u8bf7\u9009\u62e9\u4e3b\u9898"}]})(v.default.createElement(m.default,{placeholder:"\u8bf7\u9009\u62e9\u4e3b\u9898"},l.map(e=>v.default.createElement(k,{value:e.id,key:e.id},e.name))))),v.default.createElement(S,{label:"\u529f\u80fd\u8bf4\u660e"},e("tableDesc",{initialValue:f.tableDesc})(v.default.createElement(_,{rows:4,placeholder:"\u8bf7\u8f93\u5165\u5907\u6ce8\u4fe1\u606f"}))),v.default.createElement(S,{label:" ",colon:!1},e("isAuth",{valuePropName:"checked",initialValue:0!==f.isAuth})(v.default.createElement(u.default,null,"\u6388\u6743\u9700\u8981\u5ba1\u6838\uff08\u6b64\u8d44\u6e90\u9700\u8981\u901a\u8fc7\u63d0\u4f9b\u65b9\u5ba1\u6838\uff0c\u4f7f\u7528\u65b9\u65b9\u53ef\u4f7f\u7528\uff09"))),v.default.createElement(S,{label:"\u9644\u4ef6\u8bc1\u660e",extra:"\u652f\u6301\u6269\u5c55\u540d\uff1a.rar .zip .doc .docx .pdf .jpg... \uff08\u975e\u5fc5\u586b\u9879\uff09"},e("fileUrl",{})(v.default.createElement(i.default,E,v.default.createElement(n.default,null,v.default.createElement(d.default,{type:"upload"})," \u4e0a\u4f20\u6587\u4ef6")))),v.default.createElement(S,null,v.default.createElement("div",{className:C.default.action},v.default.createElement(n.default,{onClick:this.goBack,className:C.default.marginRight},"\u53d6\u6d88"),v.default.createElement(n.default,{type:"primary",onClick:this.props.next},"\u4e0b\u4e00\u6b65")))))}},p=y))||p),R=g.default.create()(w);t.default=R},gykn:function(e,t,a){"use strict";var l=a("tAuX"),s=a("g09b");Object.defineProperty(t,"__esModule",{value:!0}),t.default=void 0,a("+L6B");var r=s(a("2/Rp"));a("g9YV");var i=s(a("wCAj"));a("P2fV");var n=s(a("NJEC"));a("/zsF");var d=s(a("PArb"));a("5NDa");var u=s(a("5rEg")),o=s(a("p0pE"));a("OaEy");var c=s(a("2fM7")),h=l(a("q1tI")),m=a("LvDl"),f=s(a("SH8r")),p={},y={},g={},v=c.default.Option;class E extends h.PureComponent{constructor(e){super(e),this.isNeedLength=(e=>{var t=this.state.sourceDbType,a=!1;for(var l in y[t]){var s=y[t][l];if(l===e.dataType){a=s;break}}return a}),this.isNeedScale=(e=>{var t=this.state.sourceDbType,a=!1;for(var l in g[t]){var s=g[t][l];if(l===e.dataType){a=s;break}}return a}),this.index=0,this.cacheOriginData={},this.toggleEditable=((e,t)=>{e.preventDefault();var a=this.state.data.map(e=>(0,o.default)({},e)),l=this.getRowByKey(t,a);l&&(l.editable||(this.cacheOriginData[t]=(0,o.default)({},l)),l.editable=!l.editable,this.setState({data:a}),this.props.onChange(a))}),this.newMember=(()=>{var e,t=this.state.data.map(e=>(0,o.default)({},e)),a=t.length;0!==a&&(e="DC_DCTIMESTAMP"===t[a-1].columnName||!1);var l=e?3:0,s=a-l<0?0:a-l;t.splice(s,0,{key:"NEW_".concat(this.index),orderIndex:"",columnName:"",dataType:"",isNullAble:"Y",length:"",scale:"",isKey:"N",isEncypt:"1",comment:"",dataTypeStandard:"",lengthStandard:"",scaleStandard:"",editable:!0,isNew:!0}),this.handleFieldChange("Y","isNullAble","NEW_".concat(this.index)),this.handleFieldChange("N","isKey","NEW_".concat(this.index)),this.handleFieldChange("1","isEncypt","NEW_".concat(this.index)),this.index+=1,this.setState({data:t}),this.props.onChange(t)}),this.state={data:e.value||[],sourceDbType:e.sourceDbType,loading:!1}}componentDidMount(){this.props.onChange(this.state.data)}componentWillReceiveProps(e){"value"in e&&this.setState({data:e.value,sourceDbType:e.sourceDbType})}getRowByKey(e,t){return(t||this.state.data).filter(t=>t.key===e)[0]}remove(e){var t=this.state.data.filter(t=>t.key!==e);this.setState({data:t}),this.props.onChange(t)}handleKeyPress(e,t){"Enter"===e.key&&this.saveRow(e,t)}handleFieldChange(e,t,a,l){var s=this.state.data.map(e=>(0,o.default)({},e)),r=this.getRowByKey(a,s);if(r){var i=(0,m.isString)(e)?e:e.target.value;r[t]=i,(l||0===l)&&(r.length=this.isNeedLength(r)?r.length:null,r.scale=this.isNeedScale(r)?r.scale:null),this.setState({data:s}),this.props.onChange(s,l)}}saveRow(e,t){e.persist(),this.setState({loading:!0}),setTimeout(()=>{if(this.clickedCancel)this.clickedCancel=!1;else{var a=this.getRowByKey(t)||{};delete a.isNew,this.toggleEditable(e,t),this.props.onChange(this.state.data),this.setState({loading:!1})}},100)}cancel(e,t){this.clickedCancel=!0,e.preventDefault();var a=this.state.data.map(e=>(0,o.default)({},e)),l=this.getRowByKey(t,a);this.cacheOriginData[t]&&(Object.assign(l,this.cacheOriginData[t]),l.editable=!1,delete this.cacheOriginData[t]),this.setState({data:a}),this.props.onChange(a),this.clickedCancel=!1}render(){var e=this.state.sourceDbType;e&&p[e].map(e=>h.default.createElement(v,{key:e},e));var t=[{title:"\u53c2\u6570\u540d\u79f0",dataIndex:"columnName",key:"columnName",width:120,className:"columnName",render:(e,t)=>{return t.editable?h.default.createElement(u.default,{value:e,onChange:e=>this.handleFieldChange(e,"columnName",t.key),onKeyPress:e=>this.handleKeyPress(e,t.key)}):e}},{title:"\u63cf\u8ff0",dataIndex:"length",key:"length",render:(e,t,a)=>{if(t.editable){var l=this.isNeedLength(t);return h.default.createElement(u.default,{value:l?e:null,onChange:e=>this.handleFieldChange(e,"length",t.key,a)})}return e}},{title:"\u64cd\u4f5c",key:"action",render:(e,t)=>{return t.editable&&this.state.loading?null:"DC_DCFIELDAUD"===t.columnName||"DC_DCDATADATE"===t.columnName||"DC_DCTIMESTAMP"===t.columnName?null:t.editable?t.isNew?h.default.createElement("span",null,h.default.createElement("a",{onClick:e=>this.saveRow(e,t.key),className:f.default.action},"\u6dfb\u52a0"),h.default.createElement(d.default,{type:"vertical"}),h.default.createElement(n.default,{title:"\u662f\u5426\u8981\u5220\u9664\u6b64\u884c\uff1f",onConfirm:()=>this.remove(t.key)},h.default.createElement("a",{className:f.default.action},"\u5220\u9664"))):h.default.createElement("span",null,h.default.createElement("a",{onClick:e=>this.saveRow(e,t.key),className:f.default.action},"\u4fdd\u5b58"),h.default.createElement(d.default,{type:"vertical"}),h.default.createElement("a",{onClick:e=>this.cancel(e,t.key),className:f.default.action},"\u53d6\u6d88")):h.default.createElement("span",null,"true"===sessionStorage.fromDataManage&&"true"===sessionStorage.isNewResource?"":h.default.createElement(h.Fragment,null,h.default.createElement("a",{onClick:e=>this.toggleEditable(e,t.key),className:f.default.action},"\u7f16\u8f91"),h.default.createElement(d.default,{type:"vertical"})),h.default.createElement(n.default,{title:"\u662f\u5426\u8981\u5220\u9664\u6b64\u884c\uff1f",onConfirm:()=>this.remove(t.key)},h.default.createElement("a",{className:f.default.action},"\u5220\u9664")))}}];return h.default.createElement(h.Fragment,null,h.default.createElement(i.default,{rowKey:"key",size:"middle",loading:this.state.loading,columns:t,dataSource:this.state.data,pagination:!1,rowClassName:e=>{return e.editable?f.default.editable:""},style:{marginTop:16}}),h.default.createElement(r.default,{style:{marginTop:16,marginBottom:28},type:"primary",onClick:this.newMember,icon:"plus"},"\u65b0\u589e"))}}t.default=E},jHYr:function(e,t){function a(e){if(null==e)throw new TypeError("Cannot destructure undefined")}e.exports=a},vk7a:function(e,t,a){"use strict";var l=a("tAuX"),s=a("g09b");Object.defineProperty(t,"__esModule",{value:!0}),t.default=void 0,a("+L6B");var r=s(a("2/Rp"));a("g9YV");var i=s(a("wCAj"));a("P2fV");var n=s(a("NJEC"));a("/zsF");var d=s(a("PArb"));a("5NDa");var u=s(a("5rEg")),o=s(a("p0pE"));a("OaEy");var c=s(a("2fM7")),h=l(a("q1tI")),m=a("LvDl"),f=s(a("SH8r")),p={},y={},g={},v=c.default.Option;class E extends h.PureComponent{constructor(e){super(e),this.isNeedLength=(e=>{var t=this.state.sourceDbType,a=!1;for(var l in y[t]){var s=y[t][l];if(l===e.dataType){a=s;break}}return a}),this.isNeedScale=(e=>{var t=this.state.sourceDbType,a=!1;for(var l in g[t]){var s=g[t][l];if(l===e.dataType){a=s;break}}return a}),this.index=0,this.cacheOriginData={},this.toggleEditable=((e,t)=>{e.preventDefault();var a=this.state.data.map(e=>(0,o.default)({},e)),l=this.getRowByKey(t,a);l&&(l.editable||(this.cacheOriginData[t]=(0,o.default)({},l)),l.editable=!l.editable,this.setState({data:a}),this.props.onChange(a))}),this.newMember=(()=>{var e,t=this.state.data.map(e=>(0,o.default)({},e)),a=t.length;0!==a&&(e="DC_DCTIMESTAMP"===t[a-1].columnName||!1);var l=e?3:0,s=a-l<0?0:a-l;t.splice(s,0,{key:"NEW_".concat(this.index),orderIndex:"",columnName:"",dataType:"",isNullAble:"Y",length:"",scale:"",isKey:"N",isEncypt:"1",comment:"",dataTypeStandard:"",lengthStandard:"",scaleStandard:"",editable:!0,isNew:!0}),this.handleFieldChange("Y","isNullAble","NEW_".concat(this.index)),this.handleFieldChange("N","isKey","NEW_".concat(this.index)),this.handleFieldChange("1","isEncypt","NEW_".concat(this.index)),this.index+=1,this.setState({data:t}),this.props.onChange(t)}),this.state={data:e.value||[],sourceDbType:e.sourceDbType,loading:!1}}componentDidMount(){this.props.onChange(this.state.data)}componentWillReceiveProps(e){"value"in e&&this.setState({data:e.value,sourceDbType:e.sourceDbType})}getRowByKey(e,t){return(t||this.state.data).filter(t=>t.key===e)[0]}remove(e){var t=this.state.data.filter(t=>t.key!==e);this.setState({data:t}),this.props.onChange(t)}handleKeyPress(e,t){"Enter"===e.key&&this.saveRow(e,t)}handleFieldChange(e,t,a,l){var s=this.state.data.map(e=>(0,o.default)({},e)),r=this.getRowByKey(a,s);if(r){var i=(0,m.isString)(e)?e:e.target.value;r[t]=i,(l||0===l)&&(r.length=this.isNeedLength(r)?r.length:null,r.scale=this.isNeedScale(r)?r.scale:null),this.setState({data:s}),this.props.onChange(s,l)}}saveRow(e,t){e.persist(),this.setState({loading:!0}),setTimeout(()=>{if(this.clickedCancel)this.clickedCancel=!1;else{var a=this.getRowByKey(t)||{};delete a.isNew,this.toggleEditable(e,t),this.props.onChange(this.state.data),this.setState({loading:!1})}},100)}cancel(e,t){this.clickedCancel=!0,e.preventDefault();var a=this.state.data.map(e=>(0,o.default)({},e)),l=this.getRowByKey(t,a);this.cacheOriginData[t]&&(Object.assign(l,this.cacheOriginData[t]),l.editable=!1,delete this.cacheOriginData[t]),this.setState({data:a}),this.props.onChange(a),this.clickedCancel=!1}render(){var e=this.state.sourceDbType;e&&p[e].map(e=>h.default.createElement(v,{key:e},e));var t=[{title:"\u53c2\u6570\u540d\u79f0",dataIndex:"columnName",key:"columnName",width:120,className:"columnName",render:(e,t)=>{return t.editable?h.default.createElement(u.default,{value:e,onChange:e=>this.handleFieldChange(e,"columnName",t.key),onKeyPress:e=>this.handleKeyPress(e,t.key)}):e}},{title:"\u662f\u5426\u5fc5\u586b",dataIndex:"dataType",key:"dataType",width:100,render:(e,t,a)=>{return t.editable?h.default.createElement(c.default,{style:{fontSize:10,width:100},dropdownStyle:{fontSize:10},dropdownMatchSelectWidth:!1,value:e,onChange:e=>this.handleFieldChange(e,"dataType",t.key,a)},h.default.createElement(v,{key:"\u662f"},"\u662f"),h.default.createElement(v,{key:"\u5426"},"\u5426")):e}},{title:"\u7c7b\u578b",dataIndex:"length",key:"length",render:(e,t,a)=>{if(t.editable){var l=this.isNeedLength(t);return h.default.createElement(u.default,{value:l?e:null,onChange:e=>this.handleFieldChange(e,"length",t.key,a)})}return e}},{title:"\u63cf\u8ff0",dataIndex:"scale",key:"scale",render:(e,t,a)=>{if(t.editable){var l=this.isNeedScale(t);return h.default.createElement(u.default,{value:l?e:null,onChange:e=>this.handleFieldChange(e,"scale",t.key,a)})}return e}},{title:"\u64cd\u4f5c",key:"action",render:(e,t)=>{return t.editable&&this.state.loading?null:"DC_DCFIELDAUD"===t.columnName||"DC_DCDATADATE"===t.columnName||"DC_DCTIMESTAMP"===t.columnName?null:t.editable?t.isNew?h.default.createElement("span",null,h.default.createElement("a",{onClick:e=>this.saveRow(e,t.key),className:f.default.action},"\u6dfb\u52a0"),h.default.createElement(d.default,{type:"vertical"}),h.default.createElement(n.default,{title:"\u662f\u5426\u8981\u5220\u9664\u6b64\u884c\uff1f",onConfirm:()=>this.remove(t.key)},h.default.createElement("a",{className:f.default.action},"\u5220\u9664"))):h.default.createElement("span",null,h.default.createElement("a",{onClick:e=>this.saveRow(e,t.key),className:f.default.action},"\u4fdd\u5b58"),h.default.createElement(d.default,{type:"vertical"}),h.default.createElement("a",{onClick:e=>this.cancel(e,t.key),className:f.default.action},"\u53d6\u6d88")):h.default.createElement("span",null,"true"===sessionStorage.fromDataManage&&"true"===sessionStorage.isNewResource?"":h.default.createElement(h.Fragment,null,h.default.createElement("a",{onClick:e=>this.toggleEditable(e,t.key),className:f.default.action},"\u7f16\u8f91"),h.default.createElement(d.default,{type:"vertical"})),h.default.createElement(n.default,{title:"\u662f\u5426\u8981\u5220\u9664\u6b64\u884c\uff1f",onConfirm:()=>this.remove(t.key)},h.default.createElement("a",{className:f.default.action},"\u5220\u9664")))}}];return h.default.createElement(h.Fragment,null,h.default.createElement(i.default,{rowKey:"key",size:"middle",loading:this.state.loading,columns:t,dataSource:this.state.data,pagination:!1,rowClassName:e=>{return e.editable?f.default.editable:""},style:{marginTop:16}}),h.default.createElement(r.default,{style:{marginTop:16,marginBottom:60},type:"primary",onClick:this.newMember,icon:"plus"},"\u65b0\u589e"))}}t.default=E}}]);