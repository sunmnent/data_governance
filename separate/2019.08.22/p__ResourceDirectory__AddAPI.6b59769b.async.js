(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([[41],{"2GDt":function(e,t,a){"use strict";var n=a("g09b"),l=a("tAuX");Object.defineProperty(t,"__esModule",{value:!0}),t.default=void 0,a("T2oS");var r=n(a("W9HT")),u=n(a("Y/ft")),i=n(a("eHn4")),s=n(a("p0pE")),o=n(a("2Taf")),c=n(a("vZ4D")),d=n(a("l4Ni")),f=n(a("ujKo")),m=n(a("MhPg"));a("FJo9");var p,h,y,v=n(a("L41K")),g=l(a("q1tI")),E=a("MuoO"),C=n(a("WPgq")),b=n(a("7oMl")),N=n(a("Qyje")),k=n(a("MpEX")),D=v.default.Step,S=(p=(0,E.connect)(function(e){var t=e.resourceDirectory,a=e.cachedData,n=e.tagMange,l=e.sunmStandard,r=e.loading;return{resourceDirectory:t,cachedData:a,tagMange:n,sunmStandard:l,loading:r}}),p((y=function(e){function t(){var e,a;(0,o.default)(this,t);for(var n=arguments.length,l=new Array(n),r=0;r<n;r++)l[r]=arguments[r];return a=(0,d.default)(this,(e=(0,f.default)(t)).call.apply(e,[this].concat(l))),a.state={current:0,value:{}},a.next=function(e,t){var n=a.state,l=n.value,r=n.current,o=a.props.resourceDirectory,c=o.idItem,d=(o.systemList,N.default.parse(a.props.location.search.slice(1))),f=d.id,m=(0,s.default)({},l,(0,i.default)({},r,e));if(m[1]=m[1]||{},m[1].items=m[1].items||[],0!==r||t){var p=N.default.parse(a.props.location.search.slice(1)),h=p.id,y=[];m[1].items.forEach(function(e){if(e.isOld)y.push(e);else{e.id;var t=(0,u.default)(e,["id"]);y.push(t)}}),a.props.dispatch({type:"resourceDirectory/saveResource",payload:(0,s.default)({id:h},m[0],m[1],{items:y})})}else f||a.added||(c.forEach(function(e){m[1].items.find(function(t){return t.dataItemId===e.id})||(m[1].items.find(function(e){return e.isPk})||(e.isPk=!0,e.isNullAble="N"),m[1].items.unshift(e))}),a.added=!0),a.setState({current:r+1,value:m})},a.prev=function(e){var t=a.state,n=t.value,l=t.current;a.setState({value:(0,s.default)({},n,(0,i.default)({},l,e)),current:l-1})},a}return(0,m.default)(t,e),(0,c.default)(t,[{key:"componentDidMount",value:function(){var e=this.props.resourceDirectory,t=(e.fileTypeObj,e.multiFlagObj,e.resourceTypeObj,e.systemList),a=(e.encyptList,e.idItem,e.secondCatagory);this.props.cachedData.dataItemCatagory;t.length||this.props.dispatch({type:"resourceDirectory/getSystemList"}),a.length||this.props.dispatch({type:"resourceDirectory/queurySecondCatagory"})}},{key:"render",value:function(){var e=this.state,t=e.current,a=e.value,n=N.default.parse(this.props.location.search.slice(1)),l=n.id,u=n.type,i=!0===this.props.loading.effects["resourceDirectory/getResourceDetail"],s=[{title:"\u57fa\u672c\u4fe1\u606f",content:g.default.createElement(C.default,{next:this.next,value:a["0"]||{},id:l})},{title:"\u670d\u52a1\u4fe1\u606f",content:g.default.createElement(b.default,{prev:this.prev,next:this.next,value:a["1"]||{},id:l,type:u})}];return g.default.createElement(r.default,{spinning:i},g.default.createElement("h1",{className:k.default.title},l?"\u7f16\u8f91":"\u65b0\u5efa","API"),g.default.createElement(v.default,{current:t,className:k.default.steps},s.map(function(e){return g.default.createElement(D,{key:e.title,title:e.title})})),g.default.createElement("div",null,s[t].content))}}]),t}(g.Component),h=y))||h),_=S;t.default=_},"7oMl":function(e,t,a){"use strict";var n=a("g09b"),l=a("tAuX");Object.defineProperty(t,"__esModule",{value:!0}),t.default=void 0,a("/zsF");var r=n(a("PArb"));a("+L6B");var u=n(a("2/Rp"));a("5NDa");var i=n(a("5rEg")),s=n(a("jehZ"));a("miYZ");var o=n(a("tsqr")),c=n(a("p0pE")),d=n(a("2Taf")),f=n(a("vZ4D")),m=n(a("l4Ni")),p=n(a("ujKo")),h=n(a("MhPg")),y=n(a("jHYr"));a("y8nQ");var v=n(a("Vl3Y"));a("FJo9");var g=n(a("L41K"));a("7Kak");var E=n(a("9yH6"));a("OaEy");var C,b,N,k,D=n(a("2fM7")),S=l(a("q1tI")),_=a("MuoO"),w=a("7DNP"),T=a("LvDl"),R=n(a("vk7a")),I=n(a("gykn")),F=n(a("fym6")),A=D.default.Option,M=E.default.Group,P=(g.default.Step,{labelCol:{span:5},wrapperCol:{span:19}});function x(e){for(var t="",a=0;a<e.length;a++)e.charCodeAt(a)>65248&&e.charCodeAt(a)<65375?t+=String.fromCharCode(e.charCodeAt(a)-65248):t+=String.fromCharCode(e.charCodeAt(a));return t}var O=(C=v.default.create(),b=(0,_.connect)(function(e){return(0,y.default)(e),{resourceInfo:{},themeFormsData:{},patternFormsData:{},systemData:{},formParamsData:{},submitting:!1}}),C(N=b((k=function(e){function t(e){var a;(0,d.default)(this,t),a=(0,m.default)(this,(0,p.default)(t).call(this,e)),a.onValidateForm=function(e){var t=a.props,n=t.form,l=t.dispatch,r=t.resourceInfo,u=a.props.formParamsData,i=a.state,s=i.userId,d=i.newServiceCode;n.validateFields(function(t,a){if(!t){var n=(0,T.cloneDeep)(a);if(n.userId=s,n.isAuth=a.isAuth?1:2,n.resourceAlias=x(n.resourceAlias),"next"===e){var i={resourceAlias:n.resourceAlias,sysId:n.sysId,userId:n.userId};"true"===sessionStorage.isNewResource&&delete i.userId,l({type:"addResource/checkResourceAlias",payload:i}).then(function(e){e.success?(u=(0,c.default)({},u,n),"admin"===localStorage.authority?u.operate=1:u.operate=2,u.serviceFlag=d,"true"===sessionStorage.isNewResource?(u.isSubmit=1,l({type:"addResource/addResourceForm",payload:u}).then(function(e){e.success?(o.default.success(e.msg),l(w.routerRedux.push("/maintain")),sessionStorage.resourceId=""):o.default.error(e.msg)})):"true"===sessionStorage.isUpdateResource?(u.resourceId=sessionStorage.resourceId,l({type:"addResource/resourceUpdate",payload:u}).then(function(e){e.success?(o.default.success(e.msg),l(w.routerRedux.push("/maintain")),sessionStorage.resourceId="",sessionStorage.removeItem("isUpdateResource")):o.default.error(e.msg)})):(u.status=r.resource.status,u.isSubmit=1,u.resourceId=sessionStorage.resourceId,l({type:"addResource/editResourceForm",payload:u}).then(function(e){e.success?(o.default.success(e.msg),l(w.routerRedux.push("/maintain")),sessionStorage.resourceId=""):o.default.error(e.msg)}))):o.default.error(e.msg)})}}})},a.changeSystem=function(e,t){a.setState({userId:t.props.userid}),a.props.form.setFieldsValue({userName:t.props.username})},a.onChangeAttachment=function(e){console.log(e);var t=e.fileList;if(t=t.slice(-1),"uploading"!==e.file.status&&(!e.file.response.success||-1===e.file.response.errorCode))return o.default.error("".concat(e.file.response.msg)),void a.setState({attachmentFileList:[]});"done"===e.file.status?(o.default.success("".concat(e.file.name," \u4e0a\u4f20\u6210\u529f")),a.props.dispatch({type:"addResource/setFileName",payload:e.file.name})):"error"===e.file.status&&o.default.error("".concat(e.file.name," \u4e0a\u4f20\u5931\u8d25")),a.setState({attachmentFileList:t})},a.newServiceCode=function(){a.setState(function(e){var t=e.newServiceCode;return{newServiceCode:!t}})},a.onChangeRequest=function(){},a.onChangeRespond=function(){};a.props.resourceInfo;return a.state={userId:void 0,attachmentFileList:[],newServiceCode:!1},a.resourceId=sessionStorage.resourceId,a}return(0,h.default)(t,e),(0,f.default)(t,[{key:"render",value:function(){var e=this,t=this.props,a=t.form,n=t.themeFormsData,l=t.patternFormsData,o=t.systemData,c=t.resourceInfo,d=this.state,f=d.attachmentFileList,m=(d.newServiceCode,a.getFieldDecorator),p=c.resource,h=void 0===p?{}:p,y=[];(0,T.isEmpty)(n)||n.forEach(function(e){y.push(S.default.createElement(A,{key:e.id},e.name))});var g=[];(0,T.isEmpty)(l)||l.forEach(function(e){"\u6d88\u606f"===e.name&&e.id+"",g.push(S.default.createElement(A,{key:e.id},e.name))});var C=[];(0,T.isEmpty)(o)||(0,T.isEmpty)(o.rows)||o.rows.forEach(function(e){C.push(S.default.createElement(A,{key:e.id,userid:e.userId,username:e.userName},e.sysName))});localStorage.token,this.onChangeAttachment;return S.default.createElement(S.Fragment,null,S.default.createElement(v.default,{layout:"horizontal",className:F.default.form,hideRequiredMark:!0,style:{width:650}},S.default.createElement("div",{className:F.default.title2},"\u670d\u52a1\u4fe1\u606f"),S.default.createElement(v.default.Item,(0,s.default)({},P,{label:"\u53d1\u5e03\u65b9\u5f0f"}),m("resourceAlias",{initialValue:1})(S.default.createElement(M,null,S.default.createElement(E.default,{value:1},"http"),S.default.createElement(E.default,{value:2},"webService")))),S.default.createElement(v.default.Item,(0,s.default)({},P,{label:"\u8bf7\u6c42\u65b9\u5f0f"}),m("resourceTitle",{initialValue:1})(S.default.createElement(M,null,S.default.createElement(E.default,{value:1},"get"),S.default.createElement(E.default,{value:2},"post")))),S.default.createElement(v.default.Item,(0,s.default)({},P,{label:"\u670d\u52a1url"}),m("sysId",{initialValue:h.sysId})(S.default.createElement(S.Fragment,null,S.default.createElement(i.default,{style:{width:"60%"}}),S.default.createElement(u.default,{type:"primary",style:{marginLeft:5}},"\u6d4b\u8bd5URL")))),S.default.createElement(r.default,null),S.default.createElement("div",{className:F.default.title2},"\u8bf7\u6c42\u53c2\u6570\u8bf4\u660e"),S.default.createElement(R.default,{onChange:this.onChangeRequest}),S.default.createElement("div",{className:F.default.title2},"\u8fd4\u56de\u53c2\u6570\u8bf4\u660e"),S.default.createElement(I.default,{onChange:this.onChangeRespond}),S.default.createElement("div",{className:F.default.action},S.default.createElement(u.default,{onClick:this.props.prev,className:F.default.marginRight},"\u4e0a\u4e00\u6b65"),S.default.createElement(u.default,{type:"primary",onClick:function(){e.props.dispatch(w.routerRedux.push("/resourceDirectory/publish/maintain"))},loading:this.props.submitting},"\u63d0\u4ea4"))))}}]),t}(S.default.PureComponent),N=k))||N)||N);t.default=O},SH8r:function(e,t,a){e.exports={stepForm:"stepForm___1Yzgp",selectedButton:"selectedButton___1pKCp",data_type:"data_type___39sYM",stepThree:"stepThree___2SKiq",stepThreeButton:"stepThreeButton___2WONo",firstButton:"firstButton___3_Yy9",searchRow:"searchRow___2uvlU",modalCol:"modalCol___yuNTZ",action:"action___2R1e6",upload:"upload___1dMfR",download:"download___HCqVu",attachmentWrap:"attachmentWrap___P4OuO",attachment:"attachment___1y_Df",newServiceCode:"newServiceCode___3o24S",jdbcUrl:"jdbcUrl___2cbjj"}},WPgq:function(e,t,a){"use strict";var n=a("g09b"),l=a("tAuX");Object.defineProperty(t,"__esModule",{value:!0}),t.default=void 0,a("T2oS");var r=n(a("W9HT"));a("DZo9");var u=n(a("8z0m"));a("+L6B");var i=n(a("2/Rp"));a("Pwec");var s=n(a("CtXQ"));a("sRBo");var o=n(a("kaz8"));a("miYZ");var c=n(a("tsqr")),d=n(a("p0pE")),f=n(a("2Taf")),m=n(a("vZ4D")),p=n(a("l4Ni")),h=n(a("ujKo")),y=n(a("MhPg"));a("5NDa");var v=n(a("5rEg"));a("OaEy");var g=n(a("2fM7"));a("y8nQ");var E,C,b,N=n(a("Vl3Y")),k=l(a("q1tI")),D=a("MuoO"),S=n(a("fym6")),_=(n(a("Jt6A")),a("qxfp")),w=(n(a("Qyje")),a("7DNP")),T=a("ATFn"),R=N.default.Item,I=g.default.Option,F=v.default.TextArea,A=(E=(0,D.connect)(function(e){var t=e.resourceDirectory,a=e.cachedData,n=e.loading;return{resourceDirectory:t,cachedData:a,loading:n}}),E((b=function(e){function t(){var e,a;(0,f.default)(this,t);for(var n=arguments.length,l=new Array(n),r=0;r<n;r++)l[r]=arguments[r];return a=(0,p.default)(this,(e=(0,h.default)(t)).call.apply(e,[this].concat(l))),a.state={value:{}},a.blurTableName=function(e){var t=a.props.form,n=t.setFieldsValue,l=t.getFieldValue,r=t.validateFields;if(l("tableName")){var u=l("tableName").toUpperCase();n({tableName:u}),r(["tableName"])}},a.changeSystem=function(e){var t=a.props.form.setFieldsValue,n=a.props.resourceDirectory.systemList.find(function(t){return t.id===e});t({responsible:n&&n.account&&n.account.username})},a.handleSubmit=function(e){a.props.form.validateFieldsAndScroll(function(t,n){if(!t){n.isAuth=n.isAuth?1:0,n.resourceType="M",n.fileUrl=a.state.value.fileUrl,n.fileName=a.state.value.fileName,delete n.responsible;var l=a.props.id;a.props.dispatch({type:"resourceDirectory/saveResource",payload:(0,d.default)({id:l,submitState:e},n)})}})},a.goBack=function(){a.props.dispatch(w.routerRedux.goBack())},a}return(0,y.default)(t,e),(0,m.default)(t,[{key:"componentDidMount",value:function(){var e=this,t=this.props.resourceDirectory,a=(t.systemList,t.secondCatagory,this.props.id);a&&this.props.dispatch({type:"resourceDirectory/getResourceDetail",payload:a}).then(function(t){e.setState({value:t}),e.changeSystem(t.busSystemId)})}},{key:"render",value:function(){var e=this,t=this.props.form.getFieldDecorator,a=this.props.resourceDirectory,n=a.systemList,l=a.secondCatagory,f=!0===this.props.loading.effects["resourceDirectory/getResourceDetail"],m=this.state.value,p=this.props.id,h="".concat(_.BASE_URL,"/tableModelResource/uploadFile?token=").concat((0,_.TOKEN)());p&&(h+="&resourceId=".concat(p));var y={name:"file",action:h,onRemove:function(t){e.setState({value:(0,d.default)({},e.state.value,{fileUrl:"",fileName:""})})},beforeUpload:function(t){var a=new FormData;return a.append("file",t),fetch(h,{method:"POST",body:a}).then(function(e){return e.json()}).then(function(t){t.success?(e.setState({value:(0,d.default)({},e.state.value,{fileUrl:t.obj.fileUrl,fileName:t.obj.fileName})}),c.default.success("\u6587\u4ef6\u4e0a\u4f20\u6210\u529f")):c.default.error(t.msg)}),!1},fileList:m.fileName?[{uid:"1",name:m.fileName,status:"done",url:"".concat(_.BASE_URL,"/tableModelResource/downloadFile?token=").concat((0,_.TOKEN)(),"&fileUrl=").concat(m.fileUrl,"&fileName=").concat(m.fileName)}]:[]},E=function(e,t,a){t&&!t.match(T.ENGLISH_CHART)&&a("\u8bf7\u8f93\u5165\u4ee5\u82f1\u6587\u5f00\u5934\u7684\u82f1\u6587\u540d"),a()};return k.default.createElement(r.default,{spinning:f},k.default.createElement(N.default,{className:S.default.form},k.default.createElement(R,{label:"\u8d44\u6e90\u540d\u79f0"},t("tableName",{initialValue:m.tableName,rules:[{required:!0,message:"\u8bf7\u8f93\u5165\u8d44\u6e90\u540d\u79f0"},{max:20,message:"\u6700\u591a20\u4e2a\u5b57\u7b26"},{validator:E}]})(k.default.createElement(v.default,{onBlur:this.blurTableName,placeholder:"\u8bf7\u8f93\u5165\u8d44\u6e90\u540d\u79f0"}))),k.default.createElement(R,{label:"\u4e2d\u6587\u63cf\u8ff0"},t("tableNameCn",{initialValue:m.tableNameCn,rules:[{required:!0,message:"\u8bf7\u8f93\u5165\u4e2d\u6587\u63cf\u8ff0"}]})(k.default.createElement(v.default,{placeholder:"\u8bf7\u8f93\u5165\u4e2d\u6587\u63cf\u8ff0"}))),k.default.createElement(R,{label:"\u6e90\u7cfb\u7edf"},t("busSystemId",{initialValue:m.busSystemId||n[0]&&n[0].id,rules:[{required:!0,message:"\u8bf7\u9009\u62e9\u6e90\u7cfb\u7edf"}]})(k.default.createElement(g.default,{placeholder:"\u8bf7\u9009\u62e9\u6e90\u7cfb\u7edf",onChange:this.changeSystem,showSearch:!0,optionFilterProp:"children"},n.map(function(e){return k.default.createElement(I,{value:e.id,key:e.id},e.name)})))),k.default.createElement(R,{label:"\u8d23\u4efb\u4eba"},t("responsible",{initialValue:n[0]&&n[0].account&&n[0].account.username,rules:[{required:!0,message:"\u8bf7\u9009\u62e9\u8d23\u4efb\u4eba"}]})(k.default.createElement(v.default,{disabled:!0}))),k.default.createElement(R,{label:"\u4e3b\u9898"},t("classifyId",{initialValue:m.classifyId,rules:[{required:!0,message:"\u8bf7\u9009\u62e9\u4e3b\u9898"}]})(k.default.createElement(g.default,{placeholder:"\u8bf7\u9009\u62e9\u4e3b\u9898"},l.map(function(e){return k.default.createElement(I,{value:e.id,key:e.id},e.name)})))),k.default.createElement(R,{label:"\u529f\u80fd\u8bf4\u660e"},t("tableDesc",{initialValue:m.tableDesc})(k.default.createElement(F,{rows:4,placeholder:"\u8bf7\u8f93\u5165\u5907\u6ce8\u4fe1\u606f"}))),k.default.createElement(R,{label:" ",colon:!1},t("isAuth",{valuePropName:"checked",initialValue:0!==m.isAuth})(k.default.createElement(o.default,null,"\u6388\u6743\u9700\u8981\u5ba1\u6838\uff08\u6b64\u8d44\u6e90\u9700\u8981\u901a\u8fc7\u63d0\u4f9b\u65b9\u5ba1\u6838\uff0c\u4f7f\u7528\u65b9\u65b9\u53ef\u4f7f\u7528\uff09"))),k.default.createElement(R,{label:"\u9644\u4ef6\u8bc1\u660e",extra:"\u652f\u6301\u6269\u5c55\u540d\uff1a.rar .zip .doc .docx .pdf .jpg... \uff08\u975e\u5fc5\u586b\u9879\uff09"},t("fileUrl",{})(k.default.createElement(u.default,y,k.default.createElement(i.default,null,k.default.createElement(s.default,{type:"upload"})," \u4e0a\u4f20\u6587\u4ef6")))),k.default.createElement(R,null,k.default.createElement("div",{className:S.default.action},k.default.createElement(i.default,{onClick:this.goBack,className:S.default.marginRight},"\u53d6\u6d88"),k.default.createElement(i.default,{type:"primary",onClick:this.props.next},"\u4e0b\u4e00\u6b65")))))}}]),t}(k.Component),C=b))||C),M=N.default.create()(A);t.default=M},gykn:function(e,t,a){"use strict";var n=a("tAuX"),l=a("g09b");Object.defineProperty(t,"__esModule",{value:!0}),t.default=void 0,a("+L6B");var r=l(a("2/Rp"));a("g9YV");var u=l(a("wCAj"));a("P2fV");var i=l(a("NJEC"));a("/zsF");var s=l(a("PArb"));a("5NDa");var o=l(a("5rEg")),c=l(a("p0pE")),d=l(a("2Taf")),f=l(a("vZ4D")),m=l(a("l4Ni")),p=l(a("ujKo")),h=l(a("MhPg"));a("OaEy");var y=l(a("2fM7")),v=n(a("q1tI")),g=a("LvDl"),E=l(a("SH8r")),C={},b={},N={},k=y.default.Option,D=function(e){function t(e){var a;return(0,d.default)(this,t),a=(0,m.default)(this,(0,p.default)(t).call(this,e)),a.isNeedLength=function(e){var t=a.state.sourceDbType,n=!1;for(var l in b[t]){var r=b[t][l];if(l===e.dataType){n=r;break}}return n},a.isNeedScale=function(e){var t=a.state.sourceDbType,n=!1;for(var l in N[t]){var r=N[t][l];if(l===e.dataType){n=r;break}}return n},a.index=0,a.cacheOriginData={},a.toggleEditable=function(e,t){e.preventDefault();var n=a.state.data.map(function(e){return(0,c.default)({},e)}),l=a.getRowByKey(t,n);l&&(l.editable||(a.cacheOriginData[t]=(0,c.default)({},l)),l.editable=!l.editable,a.setState({data:n}),a.props.onChange(n))},a.newMember=function(){var e,t=a.state.data.map(function(e){return(0,c.default)({},e)}),n=t.length;0!==n&&(e="DC_DCTIMESTAMP"===t[n-1].columnName||!1);var l=e?3:0,r=n-l<0?0:n-l;t.splice(r,0,{key:"NEW_".concat(a.index),orderIndex:"",columnName:"",dataType:"",isNullAble:"Y",length:"",scale:"",isKey:"N",isEncypt:"1",comment:"",dataTypeStandard:"",lengthStandard:"",scaleStandard:"",editable:!0,isNew:!0}),a.handleFieldChange("Y","isNullAble","NEW_".concat(a.index)),a.handleFieldChange("N","isKey","NEW_".concat(a.index)),a.handleFieldChange("1","isEncypt","NEW_".concat(a.index)),a.index+=1,a.setState({data:t}),a.props.onChange(t)},a.state={data:e.value||[],sourceDbType:e.sourceDbType,loading:!1},a}return(0,h.default)(t,e),(0,f.default)(t,[{key:"componentDidMount",value:function(){this.props.onChange(this.state.data)}},{key:"componentWillReceiveProps",value:function(e){"value"in e&&this.setState({data:e.value,sourceDbType:e.sourceDbType})}},{key:"getRowByKey",value:function(e,t){return(t||this.state.data).filter(function(t){return t.key===e})[0]}},{key:"remove",value:function(e){var t=this.state.data.filter(function(t){return t.key!==e});this.setState({data:t}),this.props.onChange(t)}},{key:"handleKeyPress",value:function(e,t){"Enter"===e.key&&this.saveRow(e,t)}},{key:"handleFieldChange",value:function(e,t,a,n){var l=this.state.data.map(function(e){return(0,c.default)({},e)}),r=this.getRowByKey(a,l);if(r){var u=(0,g.isString)(e)?e:e.target.value;r[t]=u,(n||0===n)&&(r.length=this.isNeedLength(r)?r.length:null,r.scale=this.isNeedScale(r)?r.scale:null),this.setState({data:l}),this.props.onChange(l,n)}}},{key:"saveRow",value:function(e,t){var a=this;e.persist(),this.setState({loading:!0}),setTimeout(function(){if(a.clickedCancel)a.clickedCancel=!1;else{var n=a.getRowByKey(t)||{};delete n.isNew,a.toggleEditable(e,t),a.props.onChange(a.state.data),a.setState({loading:!1})}},100)}},{key:"cancel",value:function(e,t){this.clickedCancel=!0,e.preventDefault();var a=this.state.data.map(function(e){return(0,c.default)({},e)}),n=this.getRowByKey(t,a);this.cacheOriginData[t]&&(Object.assign(n,this.cacheOriginData[t]),n.editable=!1,delete this.cacheOriginData[t]),this.setState({data:a}),this.props.onChange(a),this.clickedCancel=!1}},{key:"render",value:function(){var e=this,t=this.state.sourceDbType;t&&C[t].map(function(e){return v.default.createElement(k,{key:e},e)});var a=[{title:"\u53c2\u6570\u540d\u79f0",dataIndex:"columnName",key:"columnName",width:120,className:"columnName",render:function(t,a){return a.editable?v.default.createElement(o.default,{value:t,onChange:function(t){return e.handleFieldChange(t,"columnName",a.key)},onKeyPress:function(t){return e.handleKeyPress(t,a.key)}}):t}},{title:"\u63cf\u8ff0",dataIndex:"length",key:"length",render:function(t,a,n){if(a.editable){var l=e.isNeedLength(a);return v.default.createElement(o.default,{value:l?t:null,onChange:function(t){return e.handleFieldChange(t,"length",a.key,n)}})}return t}},{title:"\u64cd\u4f5c",key:"action",render:function(t,a){return a.editable&&e.state.loading?null:"DC_DCFIELDAUD"===a.columnName||"DC_DCDATADATE"===a.columnName||"DC_DCTIMESTAMP"===a.columnName?null:a.editable?a.isNew?v.default.createElement("span",null,v.default.createElement("a",{onClick:function(t){return e.saveRow(t,a.key)},className:E.default.action},"\u6dfb\u52a0"),v.default.createElement(s.default,{type:"vertical"}),v.default.createElement(i.default,{title:"\u662f\u5426\u8981\u5220\u9664\u6b64\u884c\uff1f",onConfirm:function(){return e.remove(a.key)}},v.default.createElement("a",{className:E.default.action},"\u5220\u9664"))):v.default.createElement("span",null,v.default.createElement("a",{onClick:function(t){return e.saveRow(t,a.key)},className:E.default.action},"\u4fdd\u5b58"),v.default.createElement(s.default,{type:"vertical"}),v.default.createElement("a",{onClick:function(t){return e.cancel(t,a.key)},className:E.default.action},"\u53d6\u6d88")):v.default.createElement("span",null,"true"===sessionStorage.fromDataManage&&"true"===sessionStorage.isNewResource?"":v.default.createElement(v.Fragment,null,v.default.createElement("a",{onClick:function(t){return e.toggleEditable(t,a.key)},className:E.default.action},"\u7f16\u8f91"),v.default.createElement(s.default,{type:"vertical"})),v.default.createElement(i.default,{title:"\u662f\u5426\u8981\u5220\u9664\u6b64\u884c\uff1f",onConfirm:function(){return e.remove(a.key)}},v.default.createElement("a",{className:E.default.action},"\u5220\u9664")))}}];return v.default.createElement(v.Fragment,null,v.default.createElement(u.default,{rowKey:"key",size:"middle",loading:this.state.loading,columns:a,dataSource:this.state.data,pagination:!1,rowClassName:function(e){return e.editable?E.default.editable:""},style:{marginTop:16}}),v.default.createElement(r.default,{style:{marginTop:16,marginBottom:28},type:"primary",onClick:this.newMember,icon:"plus"},"\u65b0\u589e"))}}]),t}(v.PureComponent);t.default=D},jHYr:function(e,t){function a(e){if(null==e)throw new TypeError("Cannot destructure undefined")}e.exports=a},vk7a:function(e,t,a){"use strict";var n=a("tAuX"),l=a("g09b");Object.defineProperty(t,"__esModule",{value:!0}),t.default=void 0,a("+L6B");var r=l(a("2/Rp"));a("g9YV");var u=l(a("wCAj"));a("P2fV");var i=l(a("NJEC"));a("/zsF");var s=l(a("PArb"));a("5NDa");var o=l(a("5rEg")),c=l(a("p0pE")),d=l(a("2Taf")),f=l(a("vZ4D")),m=l(a("l4Ni")),p=l(a("ujKo")),h=l(a("MhPg"));a("OaEy");var y=l(a("2fM7")),v=n(a("q1tI")),g=a("LvDl"),E=l(a("SH8r")),C={},b={},N={},k=y.default.Option,D=function(e){function t(e){var a;return(0,d.default)(this,t),a=(0,m.default)(this,(0,p.default)(t).call(this,e)),a.isNeedLength=function(e){var t=a.state.sourceDbType,n=!1;for(var l in b[t]){var r=b[t][l];if(l===e.dataType){n=r;break}}return n},a.isNeedScale=function(e){var t=a.state.sourceDbType,n=!1;for(var l in N[t]){var r=N[t][l];if(l===e.dataType){n=r;break}}return n},a.index=0,a.cacheOriginData={},a.toggleEditable=function(e,t){e.preventDefault();var n=a.state.data.map(function(e){return(0,c.default)({},e)}),l=a.getRowByKey(t,n);l&&(l.editable||(a.cacheOriginData[t]=(0,c.default)({},l)),l.editable=!l.editable,a.setState({data:n}),a.props.onChange(n))},a.newMember=function(){var e,t=a.state.data.map(function(e){return(0,c.default)({},e)}),n=t.length;0!==n&&(e="DC_DCTIMESTAMP"===t[n-1].columnName||!1);var l=e?3:0,r=n-l<0?0:n-l;t.splice(r,0,{key:"NEW_".concat(a.index),orderIndex:"",columnName:"",dataType:"",isNullAble:"Y",length:"",scale:"",isKey:"N",isEncypt:"1",comment:"",dataTypeStandard:"",lengthStandard:"",scaleStandard:"",editable:!0,isNew:!0}),a.handleFieldChange("Y","isNullAble","NEW_".concat(a.index)),a.handleFieldChange("N","isKey","NEW_".concat(a.index)),a.handleFieldChange("1","isEncypt","NEW_".concat(a.index)),a.index+=1,a.setState({data:t}),a.props.onChange(t)},a.state={data:e.value||[],sourceDbType:e.sourceDbType,loading:!1},a}return(0,h.default)(t,e),(0,f.default)(t,[{key:"componentDidMount",value:function(){this.props.onChange(this.state.data)}},{key:"componentWillReceiveProps",value:function(e){"value"in e&&this.setState({data:e.value,sourceDbType:e.sourceDbType})}},{key:"getRowByKey",value:function(e,t){return(t||this.state.data).filter(function(t){return t.key===e})[0]}},{key:"remove",value:function(e){var t=this.state.data.filter(function(t){return t.key!==e});this.setState({data:t}),this.props.onChange(t)}},{key:"handleKeyPress",value:function(e,t){"Enter"===e.key&&this.saveRow(e,t)}},{key:"handleFieldChange",value:function(e,t,a,n){var l=this.state.data.map(function(e){return(0,c.default)({},e)}),r=this.getRowByKey(a,l);if(r){var u=(0,g.isString)(e)?e:e.target.value;r[t]=u,(n||0===n)&&(r.length=this.isNeedLength(r)?r.length:null,r.scale=this.isNeedScale(r)?r.scale:null),this.setState({data:l}),this.props.onChange(l,n)}}},{key:"saveRow",value:function(e,t){var a=this;e.persist(),this.setState({loading:!0}),setTimeout(function(){if(a.clickedCancel)a.clickedCancel=!1;else{var n=a.getRowByKey(t)||{};delete n.isNew,a.toggleEditable(e,t),a.props.onChange(a.state.data),a.setState({loading:!1})}},100)}},{key:"cancel",value:function(e,t){this.clickedCancel=!0,e.preventDefault();var a=this.state.data.map(function(e){return(0,c.default)({},e)}),n=this.getRowByKey(t,a);this.cacheOriginData[t]&&(Object.assign(n,this.cacheOriginData[t]),n.editable=!1,delete this.cacheOriginData[t]),this.setState({data:a}),this.props.onChange(a),this.clickedCancel=!1}},{key:"render",value:function(){var e=this,t=this.state.sourceDbType;t&&C[t].map(function(e){return v.default.createElement(k,{key:e},e)});var a=[{title:"\u53c2\u6570\u540d\u79f0",dataIndex:"columnName",key:"columnName",width:120,className:"columnName",render:function(t,a){return a.editable?v.default.createElement(o.default,{value:t,onChange:function(t){return e.handleFieldChange(t,"columnName",a.key)},onKeyPress:function(t){return e.handleKeyPress(t,a.key)}}):t}},{title:"\u662f\u5426\u5fc5\u586b",dataIndex:"dataType",key:"dataType",width:100,render:function(t,a,n){return a.editable?v.default.createElement(y.default,{style:{fontSize:10,width:100},dropdownStyle:{fontSize:10},dropdownMatchSelectWidth:!1,value:t,onChange:function(t){return e.handleFieldChange(t,"dataType",a.key,n)}},v.default.createElement(k,{key:"\u662f"},"\u662f"),v.default.createElement(k,{key:"\u5426"},"\u5426")):t}},{title:"\u7c7b\u578b",dataIndex:"length",key:"length",render:function(t,a,n){if(a.editable){var l=e.isNeedLength(a);return v.default.createElement(o.default,{value:l?t:null,onChange:function(t){return e.handleFieldChange(t,"length",a.key,n)}})}return t}},{title:"\u63cf\u8ff0",dataIndex:"scale",key:"scale",render:function(t,a,n){if(a.editable){var l=e.isNeedScale(a);return v.default.createElement(o.default,{value:l?t:null,onChange:function(t){return e.handleFieldChange(t,"scale",a.key,n)}})}return t}},{title:"\u64cd\u4f5c",key:"action",render:function(t,a){return a.editable&&e.state.loading?null:"DC_DCFIELDAUD"===a.columnName||"DC_DCDATADATE"===a.columnName||"DC_DCTIMESTAMP"===a.columnName?null:a.editable?a.isNew?v.default.createElement("span",null,v.default.createElement("a",{onClick:function(t){return e.saveRow(t,a.key)},className:E.default.action},"\u6dfb\u52a0"),v.default.createElement(s.default,{type:"vertical"}),v.default.createElement(i.default,{title:"\u662f\u5426\u8981\u5220\u9664\u6b64\u884c\uff1f",onConfirm:function(){return e.remove(a.key)}},v.default.createElement("a",{className:E.default.action},"\u5220\u9664"))):v.default.createElement("span",null,v.default.createElement("a",{onClick:function(t){return e.saveRow(t,a.key)},className:E.default.action},"\u4fdd\u5b58"),v.default.createElement(s.default,{type:"vertical"}),v.default.createElement("a",{onClick:function(t){return e.cancel(t,a.key)},className:E.default.action},"\u53d6\u6d88")):v.default.createElement("span",null,"true"===sessionStorage.fromDataManage&&"true"===sessionStorage.isNewResource?"":v.default.createElement(v.Fragment,null,v.default.createElement("a",{onClick:function(t){return e.toggleEditable(t,a.key)},className:E.default.action},"\u7f16\u8f91"),v.default.createElement(s.default,{type:"vertical"})),v.default.createElement(i.default,{title:"\u662f\u5426\u8981\u5220\u9664\u6b64\u884c\uff1f",onConfirm:function(){return e.remove(a.key)}},v.default.createElement("a",{className:E.default.action},"\u5220\u9664")))}}];return v.default.createElement(v.Fragment,null,v.default.createElement(u.default,{rowKey:"key",size:"middle",loading:this.state.loading,columns:a,dataSource:this.state.data,pagination:!1,rowClassName:function(e){return e.editable?E.default.editable:""},style:{marginTop:16}}),v.default.createElement(r.default,{style:{marginTop:16,marginBottom:60},type:"primary",onClick:this.newMember,icon:"plus"},"\u65b0\u589e"))}}]),t}(v.PureComponent);t.default=D}}]);