(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([[22],{"3Xs+":function(e,t,a){"use strict";var l=a("g09b"),d=a("tAuX");Object.defineProperty(t,"__esModule",{value:!0}),t.default=void 0,a("2qtc");var s=l(a("kLXV"));a("g9YV");var i=l(a("wCAj"));a("P2fV");var n=l(a("NJEC"));a("Pwec");var r=l(a("CtXQ"));a("jCWc");var o=l(a("kPKH"));a("+L6B");var u=l(a("2/Rp"));a("14J3");var c=l(a("BMrR"));a("5NDa");var m=l(a("5rEg")),h=l(a("p0pE"));a("miYZ");var p=l(a("tsqr"));a("OaEy");var f=l(a("2fM7"));a("y8nQ");var v,b,y,I=l(a("Vl3Y")),g=d(a("q1tI")),E=a("MuoO"),N=l(a("Mosh")),C=l(a("LvDl")),w=a("+mQZ"),V=l(a("PVYr")),x=I.default.Item,k=f.default.Option;class D extends g.Component{constructor(e){super(e),this.onChangeType=(e=>{this.setState({keyType:e})}),this.onChangeDataItem=((e,t)=>{if(t&&t.length>0){var a=t.map(e=>({dataItemId:e.props.value,dataItemName:e.key,chineseName:e.props.children}));this.setState({selectDataItems:a})}}),this.save=(()=>{var e=this.state,t=e.keyType,a=e.selectDataItems;this.props.form.validateFields((e,l)=>{e||(3==t&&a.length<=1?p.default.warning("\u5f53\u524d\u7d22\u5f15\u7c7b\u578b\u4e3a\u7ec4\u5408\u7d22\u5f15\uff0c\u8bf7\u9009\u62e9\u4e24\u9879\u53ca\u4ee5\u4e0a\u6570\u636e\u9879"):(l.items=a,this.props.modalClose(l)))})}),this.cancel=(()=>{this.props.modalClose()}),this.state={dataMap:(0,h.default)({},e.modalInfo),optionDisabled:e.optionDisabled||!1,keyType:"",selectDataItems:[],dataItemIds:[]}}componentDidMount(){this.setState(e=>{var t=e.dataMap;if(t&&t.items){var a=t.items.map(e=>e.dataItemId);return{dataItemIds:a,selectDataItems:t.items,keyType:t.indexType}}})}render(){var e=this.state,t=e.dataMap,a=e.dataItemIds,l=this.props.form.getFieldDecorator;return g.default.createElement(g.Fragment,null,g.default.createElement(I.default,{className:"fs1 cfs1"},g.default.createElement(c.default,null,g.default.createElement(x,{label:"\u7d22\u5f15\u540d\u79f0",className:"fs1-item"},l("indexName",{initialValue:t.indexName,rules:[{required:!0,message:"\u8bf7\u8f93\u5165\u7d22\u5f15\u540d\u79f0\uff01"}]})(g.default.createElement(m.default,{className:"fs1-controler",maxLength:500,placeholder:"\u7d22\u5f15\u540d\u79f0"})))),g.default.createElement(c.default,null,g.default.createElement(x,{label:"\u7d22\u5f15\u7f16\u7801",className:"fs1-item"},l("indexCode",{initialValue:t.indexCode,rules:[{required:!0,message:"\u8bf7\u8f93\u5165\u7d22\u5f15\u7f16\u7801\uff01"}]})(g.default.createElement(m.default,{className:"fs1-controler",maxLength:500,placeholder:"\u7d22\u5f15\u7f16\u7801"})))),g.default.createElement(c.default,null,g.default.createElement(x,{label:"\u7d22\u5f15\u7c7b\u578b",className:"fs1-item"},l("indexType",{initialValue:t.indexType,rules:[{required:!0,message:"\u8bf7\u9009\u62e9\u7d22\u5f15\u7c7b\u578b\uff01"}]})(g.default.createElement(f.default,{style:{width:"100%"},placeholder:"\u7d22\u5f15\u7c7b\u578b",onChange:this.onChangeType},g.default.createElement(k,{value:2},"\u666e\u901a\u7d22\u5f15"),g.default.createElement(k,{value:3},"\u7ec4\u5408\u7d22\u5f15"))))),g.default.createElement(c.default,null,g.default.createElement(x,{label:"\u6570\u636e\u9879",className:"fs1-item"},l("items",{initialValue:a,rules:[{required:!0,message:"\u8bf7\u9009\u62e9\u6570\u636e\u9879\uff01"}]})(g.default.createElement(f.default,{mode:"multiple",style:{width:"100%"},placeholder:"\u6570\u636e\u9879\u4e2d\u6587\u7b80\u79f0",onChange:(e,t)=>this.onChangeDataItem(e,t)},this.props.dataItems&&this.props.dataItems.map(e=>g.default.createElement(k,{value:e.dataItemId,key:e.dataItemName},e.chineseName))))))),g.default.createElement(c.default,{className:"margin-top10"},g.default.createElement(o.default,{span:24,className:"text-center"},g.default.createElement(u.default,{type:"primary",size:"small",onClick:this.save,className:"margin-right8"},"\u786e\u5b9a"),g.default.createElement(u.default,{size:"small",onClick:this.cancel},"\u53d6\u6d88"))))}}var M=I.default.create()(D),R=(v=(0,E.connect)(e=>{var t=e.dataRelationship;return{dataRelationship:t}}),v((y=class extends g.Component{constructor(e){super(e),this.columns=(()=>{var e="view"===this.props.type,t=[{title:"\u7d22\u5f15\u540d\u79f0",dataIndex:"indexName",width:200},{title:"\u7d22\u5f15\u7f16\u7801",dataIndex:"indexCode",width:200},{title:"\u7d22\u5f15\u7c7b\u578b",dataIndex:"indexType",width:120,render:(e,t)=>1==e?"\u4e3b\u952e\u7d22\u5f15":2==e?"\u666e\u901a\u7d22\u5f15":3==e?"\u7ec4\u5408\u7d22\u5f15":""},{title:"\u4e2d\u6587\u7b80\u79f0",key:"chineseName",width:150,render:(e,t)=>{var a=t.items,l=[];return a&&a.length>0&&a.forEach(e=>{l.push(e.chineseName)}),l&&l.length>0?g.default.createElement("span",null,l.join(";")):""}},{title:"\u6570\u636e\u9879\u540d",key:"dataItemName",width:150,render:(e,t)=>{var a=t.items,l=[];return a&&a.length>0&&a.forEach(e=>{l.push(e.dataItemName)}),l&&l.length>0?g.default.createElement("span",null,l.join(";")):""}},{title:"\u64cd\u4f5c",dataIndex:"operate",align:"center",render:(e,t,a)=>g.default.createElement(g.Fragment,null,g.default.createElement(r.default,{type:"edit",onClick:()=>{this.tableAction({type:"edit",key:"bjsy",record:t})},style:{marginRight:15,cursor:"pointer"}}),g.default.createElement(n.default,{title:"\u786e\u5b9a\u8981\u5220\u9664\u5417\uff1f",onConfirm:this.deleteRecord.bind(this,a)},g.default.createElement(r.default,{type:"delete",style:{cursor:"pointer"}}))),width:100}];return e?t.slice(0,-1):t})(),this.modalContent={bjsy:M},this.tableAction=(e=>{var t=e.type,a=e.key,l=e.record,d=void 0===l?{}:l;switch(t){case"add":this.setState({modalVisible:!0,modalType:t,modalKey:a,modalInfo:{}});break;case"edit":this.setState({modalVisible:!0,modalType:t,modalKey:a,modalInfo:(0,h.default)({},d)});break}}),this.deleteRecord=(e=>{var t=C.default.cloneDeep(this.props.dataRelationship.standardInfo),a=t.tableModel.indexs;a.splice(e,1),this.props.dispatch({type:"dataRelationship/save",payload:{standardInfo:t}})}),this.modalClose=(e=>{var t=this.state,a=t.modalType,l=t.modalInfo;if(e){var d=C.default.cloneDeep(this.props.dataRelationship.standardInfo),s=d.tableModel.indexs,i=void 0===s?[]:s;if("add"===a)i.push((0,h.default)({key:N.default.uuid()},e));else if("edit"===a){var n=i.findIndex(e=>e.id===l.id);i[n]=(0,h.default)({},l,e)}d.tableModel.indexs=i,this.props.dispatch({type:"dataRelationship/save",payload:{standardInfo:d}}),this.setState({modalVisible:!1,modalKey:1})}else this.setState({modalVisible:!1,modalKey:1})}),this.state={modalVisible:!1,modalKey:1,modalInfo:{},optionDisabled:!1}}render(){var e=this.props.dataRelationship.standardInfo.tableModel,t=void 0===e?{}:e,a=this.state,l=a.modalVisible,d=a.modalType,n=a.modalKey,r=a.modalInfo,o=a.optionDisabled,c="view"===this.props.type;return g.default.createElement(g.Fragment,null,g.default.createElement("div",{className:V.default.title},"\u7d22\u5f15\u4fe1\u606f"),g.default.createElement("div",null,!c&&g.default.createElement(u.default,{icon:"plus",size:"small",onClick:()=>this.tableAction({type:"add",key:"bjsy"})},"\u65b0\u5efa\u7d22\u5f15")),g.default.createElement(i.default,{bordered:!0,columns:this.columns,dataSource:t.indexs,pagination:!1,size:"small",rowKey:(e,t)=>t,style:{marginTop:10}}),g.default.createElement(s.default,{visible:l,title:"".concat("add"===d?"\u65b0\u589e":"\u7f16\u8f91","\u7d22\u5f15"),footer:null,maskClosable:!1,width:"50%",onCancel:()=>this.modalClose("")},this.modalContent[n]&&(0,w.InjectControler)(this.modalContent[n],{modalInfo:r,dataItems:t.items,optionDisabled:o,modalClose:e=>this.modalClose(e)})))}},b=y))||b);t.default=R},"70sc":function(e,t,a){"use strict";var l=a("g09b"),d=a("tAuX");Object.defineProperty(t,"__esModule",{value:!0}),t.default=void 0,a("2qtc");var s=l(a("kLXV"));a("g9YV");var i=l(a("wCAj")),n=l(a("p0pE"));a("P2fV");var r=l(a("NJEC"));a("Pwec");var o=l(a("CtXQ"));a("5NDa");var u=l(a("5rEg"));a("Q9mQ");var c=l(a("diRs"));a("miYZ");var m=l(a("tsqr"));a("OaEy");var h,p,f,v=l(a("2fM7")),b=d(a("q1tI")),y=a("MuoO"),I=l(a("LGns")),g=l(a("LvDl")),E=l(a("PVYr")),N=l(a("uCBh")),C=v.default.Option,w=10,V=(h=(0,y.connect)(e=>{var t=e.sunmQualityControl,a=e.resourceDirectory,l=e.dataRelationship;return{sunmQualityControl:t,resourceDirectory:a,dataRelationship:l}}),h((f=class extends b.Component{constructor(){super(...arguments),this.state={modalVisible:!1,modalKey:"",tableList:[],allTableData:[]},this.columns=(()=>{var e="view"===this.props.type,t=[{title:"\u4e2d\u6587\u7b80\u79f0",dataIndex:"chineseName",width:150},{title:"\u6570\u636e\u9879\u540d",dataIndex:"dataItemName",width:150},{title:"\u7c7b\u578b",dataIndex:"dataTypeName",width:120},{title:"\u957f\u5ea6",dataIndex:"length",width:80},{title:"\u7cbe\u5ea6",dataIndex:"percision",width:80},{title:"\u68c0\u6838\u7c7b\u522b",dataIndex:"checkType",width:150,render:(t,a)=>{var l=a.rules.map(e=>e.typeName);return a.checkRules.length>0&&b.default.createElement("span",{className:"block font-size12 text-ellipsis",style:{width:125,height:30,cursor:"pointer"},onClick:()=>{I.default.getStandardCheckType({id:a.dataItemId}).then(e=>{e&&e.success?this.tableAction({type:"a",key:"rules",id:a.dataItemId,value:{dataItemId:a.dataItemId,list:e.obj}}):e&&m.default.error(e.msg)})}},l.length>0?b.default.createElement("a",{className:"inline-block margin-top5 v-align-middle",title:l.join("/")},l.join("/")):!e&&b.default.createElement("a",{style:{color:"#1890ff",fontSize:"20px",textAlign:"center"},className:"inline-block v-align-middle"},"+"))}},{title:"\u7f16\u7801\u6807\u51c6",dataIndex:"codeName",width:150,render:(e,t)=>{var a=t.codestandard&&t.codestandard.id;return b.default.createElement(c.default,{content:this.popoverContent(a),placement:"left"},b.default.createElement("div",{onMouseEnter:this.mouseEnterHandle.bind(this,a)},t.codestandard&&t.codestandard.codeName))}},{title:"\u662f\u5426\u4e3a\u7a7a",dataIndex:"isNullAble",align:"center",width:100,render:(t,a,l)=>b.default.createElement(v.default,{size:"small",value:t,onChange:this.changeValue.bind(this,l,"isNullAble"),disabled:e,style:{width:"90%"}},b.default.createElement(C,{value:"Y"},"\u662f"),b.default.createElement(C,{value:"N"},"\u5426"))},{title:"\u662f\u5426\u4e3b\u952e",key:"isPk",align:"center",width:100,render:(t,a,l)=>b.default.createElement(v.default,{size:"small",value:a.isPk?2:1,onChange:e=>{this.changeValue(l,"isPk",2===e),requestAnimationFrame(()=>{this.changeValue(l,"isNullAble","N")})},disabled:e,style:{width:"90%"}},b.default.createElement(C,{value:2},"\u662f"),b.default.createElement(C,{value:1},"\u5426"))},{title:"\u5b89\u5168\u9009\u9879",dataIndex:"isEncypt",align:"center",width:120,render:(t,a,l)=>{var d=this.props.resourceDirectory.encyptList;return b.default.createElement(v.default,{size:"small",value:t,onChange:this.changeValue.bind(this,l,"isEncypt"),disabled:e,style:{width:"90%"}},Object.entries(d).map(e=>b.default.createElement(C,{value:e[1],key:e[1]},e[0])))}},{title:"\u4e1a\u52a1\u5b9a\u4e49\u53ca\u89c4\u5219",dataIndex:"businessDefinition",align:"center",width:180,render:(t,a,l)=>b.default.createElement(u.default,{size:"small",value:t,onChange:this.changeValue.bind(this,l,"businessDefinition"),disabled:e,style:{width:"90%"}})},{title:"\u5916\u8054\u8868",dataIndex:"frTableId",render:(t,a,l)=>b.default.createElement(v.default,{allowClear:!0,showSearch:!0,size:"small",value:t,optionFilterProp:"children",dropdownClassName:"modal-select",onChange:e=>{this.changeValue(l,"frTableId",e),requestAnimationFrame(()=>{this.changeValue(l,"frTableItemId","")})},disabled:e,filterOption:(e,t)=>t.props.children.toLowerCase().indexOf(e.toLowerCase())>=0,style:{width:180}},this.state.tableList.map((e,t)=>b.default.createElement(C,{value:e.id,key:e.value},e.label))),align:"center",width:200},{title:"\u5916\u8054\u5b57\u6bb5",dataIndex:"frTableItemId",render:(t,a,l)=>{var d=this.state.allTableData,s=[],i=[];if(a.frTableId){d&&d.length>0&&(s=d.filter(e=>e.id==a.frTableId));var n=s[0]?s[0].items:[];i=n.map(e=>({id:e.id,value:e.dataItemId,label:e.chineseName}))}return b.default.createElement(v.default,{showSearch:!0,allowClear:!0,size:"small",dropdownClassName:"modal-select",value:a.frTableItemId,optionFilterProp:"children",onChange:this.changeValue.bind(this,l,"frTableItemId"),disabled:e,filterOption:(e,t)=>t.props.children.toLowerCase().indexOf(e.toLowerCase())>=0,style:{width:"90%"}},i.map((e,t)=>b.default.createElement(C,{value:e.id,key:e.value},e.label)))},align:"center",width:200},{title:"\u7248\u672c\u4fe1\u606f",dataIndex:"stvVersion",width:120},{title:"\u64cd\u4f5c",dataIndex:"operate",align:"center",render:(e,t,a)=>b.default.createElement(r.default,{title:"\u5220\u9664\u6570\u636e\u9879\u5c06\u5f71\u54cd\u5230\u7d22\u5f15\u7684\u5f15\u7528\uff0c\u786e\u5b9a\u8981\u5220\u9664\u5417\uff1f",onConfirm:this.deleteRecord.bind(this,a)},b.default.createElement(o.default,{type:"delete",style:{cursor:"pointer"}})),fixed:"right",width:60}];return e?t.slice(0,-1):t})(),this.popOverColumns=[{title:"\u4ee3\u7801\u503c",dataIndex:"code",key:"code"},{title:"\u4ee3\u7801\u542b\u4e49",dataIndex:"name",key:"name"}],this.fetchTable=(e=>I.default.fetchTable(e).then(e=>{if(e&&e.obj){var t=e.obj.map(e=>({id:e.id,value:e.id,label:"".concat(e.tableName," (").concat(e.tableNameCn,")")}));this.setState({tableList:t,allTableData:e.obj})}})),this.changeValue=((e,t,a)=>{var l="object"===typeof a?a.target.value:a,d=g.default.cloneDeep(this.props.dataRelationship.standardInfo);d.tableModel.items[e][t]=l,this.props.dispatch({type:"dataRelationship/save",payload:{standardInfo:d}})}),this.tableAction=(e=>{var t=e.type,a=e.key,l=e.id,d=e.value,s=this.props.dataRelationship.standardInfo.tableModel.items,i=s.find(e=>e.dataItemId===l)[a],r=[],o={},u=d.list,c=d.dataItemId;u.forEach(e=>{delete e.id,i&&i.length>0&&i.forEach(t=>{e.typeId==t.typeId&&(e=t)}),o[e.typeId]=(0,n.default)({},e)}),i&&i.length>0&&i.forEach(e=>{r.push(e.typeId)});var m={dataItemId:c,selectedRowKeys:r,checkRules:o};this.setState({modalVisible:!0,modalKey:222,modalInfo:{type:t,key:a,id:l,value:m}})}),this.popoverContent=(e=>{var t=this.props.sunmQualityControl.allCodePages,a=t[e]||{},l=a.list,d=a.pageNum,s=a.total;return b.default.createElement(i.default,{pagination:{pageSize:w,current:d,total:s},onChange:this.changePopOverTable.bind(this,e),size:"small",dataSource:l,columns:this.popOverColumns,rowKey:"id",className:E.default.popoverTable})}),this.mouseEnterHandle=((e,t)=>{var a=this.props.sunmQualityControl.allCodePages;a[e]||(this.requestIn||(this.requestIn=[]),this.requestIn.includes(e)||(this.requestIn.push(e),this.props.dispatch({type:"sunmQualityControl/getCodePages",payload:{id:e,pageNum:1,pageSize:w}}).finally(()=>{this.requestIn=this.requestIn.filter(t=>t!==e)})))}),this.changePopOverTable=((e,t,a,l)=>{this.requestIn.push(e),this.props.dispatch({type:"sunmQualityControl/getCodePages",payload:{id:e,pageNum:t.current,pageSize:w}}).finally(()=>{this.requestIn=this.requestIn.filter(t=>t!==e)})}),this.deleteRecord=(e=>{var t=g.default.cloneDeep(this.props.dataRelationship.standardInfo),a=t.tableModel.items[e].dataItemName,l=t.dataIntegrateVo,d=void 0===l?{}:l,s=d.dataFlows,i=void 0===s?[]:s;d.dataFlows=i.filter(e=>e.targetFieldName!==a);var n=a=>a.some(a=>a.dataItemId===t.tableModel.items[e].dataItemId);t.tableModel.indexs=(t.tableModel.indexs||[]).filter(e=>!n(e.items)),t.tableModel.items.splice(e,1),this.props.dispatch({type:"dataRelationship/save",payload:{standardInfo:t}})}),this.modalClose=(e=>{if(e){var t=this.state.modalInfo,a=g.default.cloneDeep(this.props.dataRelationship.standardInfo),l=a.tableModel.items,d=l.find(e=>e.dataItemId===t.id);d.rules=e,this.props.dispatch({type:"dataRelationship/save",payload:{standardInfo:a}}),this.setState({modalInfo:{},modalKey:2,modalVisible:!1})}else this.setState({modalKey:2,modalVisible:!1})})}componentDidMount(){var e=this.props.id;this.fetchTable({id:e,type:2})}render(){var e=this.props.dataRelationship.standardInfo.tableModel,t=void 0===e?{}:e,a=this.state,l=a.modalVisible,d=a.modalKey;return b.default.createElement("div",null,b.default.createElement("div",{className:E.default.title},"\u6807\u51c6\u8868\u7ed3\u6784"),b.default.createElement(i.default,{columns:this.columns,dataSource:t.items,scroll:{x:1700},rowKey:"dataItemId"}),b.default.createElement(s.default,{key:d,visible:l,title:"\u7f16\u8f91\u68c0\u6838\u7c7b\u522b",footer:null,maskClosable:!1,width:"70%",onCancel:this.modalClose},l&&b.default.createElement(N.default,{data:()=>this.state.modalInfo.value,dataItems:()=>{var e={};return t.items.forEach(t=>{e[t.dataItemId]=t}),e},modalClose:this.modalClose})))}},p=f))||p),x=V;t.default=x},GKUq:function(e,t,a){"use strict";var l=a("g09b"),d=a("tAuX");Object.defineProperty(t,"__esModule",{value:!0}),t.default=void 0,a("y8nQ");var s=l(a("Vl3Y"));a("+L6B");var i,n,r,o=l(a("2/Rp")),u=l(a("p0pE")),c=d(a("q1tI")),m=a("MuoO"),h=a("7DNP"),p=l(a("LvDl")),f=l(a("tSUh")),v=l(a("PVYr")),b=l(a("Tw//")),y=l(a("3Xs+")),I=l(a("70sc")),g=l(a("S7zV")),E=(i=(0,m.connect)(e=>{var t=e.dataRelationship,a=e.resourceDirectory,l=e.sunmQualityControl,d=e.cachedData;return{dataRelationship:t,resourceDirectory:a,sunmQualityControl:l,cachedData:d}}),i((r=class extends c.Component{constructor(){super(...arguments),this.goBack=(()=>{this.props.dispatch(h.routerRedux.goBack())}),this.submit=(e=>{var t=this.props.dataRelationship.targetDataSource,a=p.default.cloneDeep(this.props.dataRelationship.standardInfo);a.tableModel.type=2,a.tableModel.busSystemId=a.dataCollection.systemId,a.dataIntegrateVo.dataFlows=a.dataIntegrateVo.dataFlows.filter(e=>e.targetFieldName),a.dataIntegrateVo.dataFlows.forEach(e=>{e.targetTableName=a.tableModel.tableName}),a.dataIntegrateVo.integrateSources=a.dataIntegrateVo.integrateSources.map(e=>(0,u.default)({id:"",integrateId:""},e,{sourceId:a.dataCollection.sourceId,sourceTabName:a.dataCollection.tableName})),a.dataIntegrateVo.dataIntegrate.targetTabName=a.tableModel.tableName,a.dataIntegrateVo.dataIntegrate.sourceId=t[0].id,this.props.dispatch({type:"dataRelationship/saveStandardData",payload:(0,u.default)({},a,{operation:e})}).then(this.goBack)})}componentDidMount(){var e=this.props.match.params.id;this.props.dispatch({type:"dataRelationship/getStandardInfo",payload:{id:e}}),this.props.dispatch({type:"dataRelationship/queryTargetDataSource",payload:{sourceName:"\u6807\u51c6\u5e93"}}),Object.keys(this.props.resourceDirectory.encyptList).length||this.props.dispatch({type:"resourceDirectory/getEncyptList"})}render(){var e=this.props.match.params.id,t=this.props.location.query.type;return c.default.createElement("div",{className:v.default.all},c.default.createElement(f.default,null),c.default.createElement(b.default,{type:t}),c.default.createElement(g.default,{type:t}),c.default.createElement(I.default,{id:e,type:t}),c.default.createElement(y.default,{type:t}),"view"!==t&&c.default.createElement("div",{className:v.default.btns},c.default.createElement(o.default,{onClick:this.goBack},"\u53d6\u6d88"),c.default.createElement(o.default,{onClick:this.submit.bind(this,1)},"\u4fdd\u5b58"),c.default.createElement(o.default,{onClick:this.submit.bind(this,2),type:"primary",htmlType:"submit"},"\u63d0\u4ea4")),c.default.createElement("div",{className:v.default.explain},"\u8bf4\u660e\uff1a1.\u63d0\u4ea4\u540e\u8bf7\u5728\u2018\u6570\u636e\u6807\u51c6\u5ba1\u6838\u2019\u9875\u9762\u627e\u5230\u5f53\u524d\u6807\u51c6\u8868\u5ba1\u6838"))}},n=r))||n),N=s.default.create()(E);t.default=N},PVYr:function(e,t,a){e.exports={all:"all___2jOs3",title:"title___1Nsl_",twoColumns:"twoColumns___1hO4y",label:"label___1wTLt",btns:"btns___1MQLA",explain:"explain___WHAmu"}},S7zV:function(e,t,a){"use strict";var l=a("g09b"),d=a("tAuX");Object.defineProperty(t,"__esModule",{value:!0}),t.default=void 0,a("g9YV");var s=l(a("wCAj")),i=l(a("p0pE"));a("5NDa");var n=l(a("5rEg"));a("OaEy");var r,o,u,c=l(a("2fM7")),m=d(a("q1tI")),h=a("MuoO"),p=l(a("LvDl")),f=l(a("PVYr")),v=l(a("RSsB")),b=c.default.Option,y=(r=(0,h.connect)(e=>{var t=e.dataRelationship;return{dataRelationship:t}}),r((u=class extends m.Component{constructor(){super(...arguments),this.state={modalVisible:!1,record:{}},this.columns=(()=>{var e="view"===this.props.type,t=[{title:"\u6570\u636e\u9879",dataIndex:"name"},{title:"\u4e2d\u6587\u7b80\u79f0",dataIndex:"age"},{title:"\u7c7b\u578b",dataIndex:"type"},{title:"\u957f\u5ea6",dataIndex:"length"},{title:"\u6570\u636e\u9879",dataIndex:"targetFieldName",render:(t,a,l)=>{var d=this.props.dataRelationship.standardInfo.tableModel,s=void 0===d?{}:d,i=this.findByName(a.name);return m.default.createElement(c.default,{value:i.targetFieldName,onChange:this.changeValue.bind(this,a,"targetFieldName"),allowClear:!0,disabled:e,style:{width:120}},s.items&&s.items.map(e=>m.default.createElement(b,{value:e.dataItemName,key:e.dataItemName},e.dataItemName)))}},{title:"\u5b57\u6bb5\u89c4\u5219",dataIndex:"rule",render:(t,a,l)=>{var d=this.findByName(a.name);return m.default.createElement(n.default,{value:d.rule,onChange:this.changeValue.bind(this,a,"rule"),disabled:e||!d.targetFieldName})}},{title:"\u64cd\u4f5c",dataIndex:"actions",render:(e,t,a)=>m.default.createElement("span",{onClick:this.showModal.bind(this,t),style:{cursor:"pointer",color:"#1890ff"}},"\u9009\u62e9\u6570\u636e\u9879")}];return e?t.slice(0,-1):t})(),this.findByName=(e=>{var t=this.props.dataRelationship.standardInfo.dataIntegrateVo,a=void 0===t?{}:t,l=a.dataFlows,d=void 0===l?[]:l,s=d.find(t=>t.sourceFieldName===e);return s||{}}),this.changeValue=((e,t,a)=>{var l="object"===typeof a?a.target.value:a,d=p.default.cloneDeep(this.props.dataRelationship.standardInfo),s=d.dataIntegrateVo.dataFlows.findIndex(t=>t.sourceFieldName===e.name);if(-1===s){var i=d.dataCollection,n=void 0===i?{}:i,r=this.props.dataRelationship.targetDataSource,o={id:"",sourceDatasourceId:n.sourceId,sourceTableName:n.tableName,targetTableName:"",sourceFieldName:e.name,targetDatasourceId:r[0].id,targetFieldName:"",rule:"",[t]:l};d.dataIntegrateVo.dataFlows.push(o)}else d.dataIntegrateVo.dataFlows[s][t]=l;this.props.dispatch({type:"dataRelationship/save",payload:{standardInfo:d}})}),this.showModal=(e=>{this.setState({modalVisible:!0,record:e})}),this.hideModal=(()=>{this.setState({modalVisible:!1})}),this.addData=(e=>{var t=e.map(e=>(0,i.default)({isNullAble:"Y",isEncypt:1},e,{id:""})),a=p.default.cloneDeep(this.props.dataRelationship.standardInfo);a.tableModel.items.push(...t),this.props.dispatch({type:"dataRelationship/save",payload:{standardInfo:a}}),this.changeValue(this.state.record,"targetFieldName",t[0].dataItemName)})}render(){var e=this.props.dataRelationship.standardInfo,t=e.dataCollection,a=void 0===t?{}:t,l=e.tableModel,d=void 0===l?{}:l,i=this.state.modalVisible;return m.default.createElement("div",null,m.default.createElement("div",{className:f.default.title},"\u6570\u636e\u6620\u5c04\u5173\u7cfb"),m.default.createElement(s.default,{columns:this.columns,dataSource:a.columnsList,rowKey:"id"}),m.default.createElement(v.default,{addData:this.addData,existData:d.items||[],modalVisible:i,hideModal:this.hideModal}))}},o=u))||o),I=y;t.default=I},"Tw//":function(e,t,a){"use strict";var l=a("g09b"),d=a("tAuX");Object.defineProperty(t,"__esModule",{value:!0}),t.default=void 0,a("7Kak");var s=l(a("9yH6")),i=l(a("qIgq"));a("miYZ");var n=l(a("tsqr"));a("5NDa");var r=l(a("5rEg"));a("OaEy");var o,u,c,m=l(a("2fM7")),h=d(a("q1tI")),p=a("MuoO"),f=l(a("LvDl")),v=l(a("PVYr")),b=a("ATFn"),y=m.default.Option,I=r.default.TextArea,g=(o=(0,p.connect)(e=>{var t=e.dataRelationship;return{dataRelationship:t}}),o((c=class extends h.Component{constructor(){super(...arguments),this.changeValue=((e,t)=>{var a="object"===typeof t?t.target.value:t;if("tableModel.tableName"!==e||!a||a.match(b.ENGLISH_CHART)){var l=e.split("."),d=(0,i.default)(l,2),s=d[0],r=d[1],o=f.default.cloneDeep(this.props.dataRelationship.standardInfo);"dataIntegrate"===s?o.dataIntegrateVo[s][r]=a:o[s][r]=a,this.props.dispatch({type:"dataRelationship/save",payload:{standardInfo:o}})}else n.default.error("\u8bf7\u8f93\u5165\u4ee5\u82f1\u6587\u5f00\u5934\u7684\u82f1\u6587\u540d")}),this.changeLogTable=(e=>{var t=e.target.value;this.changeValue("tableModel.isLogTable",t),requestAnimationFrame(()=>{this.changeValue("tableModel.isIncriease",t)})})}render(){var e=this.props.dataRelationship.standardInfo,t=e.tableModel,a=void 0===t?{}:t,l=e.dataIntegrateVo,d=void 0===l?{}:l,i=e.dataCollection,n=void 0===i?{}:i,o=d.dataIntegrate,u=void 0===o?{}:o,c="view"===this.props.type;return h.default.createElement("div",null,h.default.createElement("div",{className:v.default.title},"\u6e90\u8868\u4fe1\u606f"),h.default.createElement("div",{className:v.default.twoColumns},h.default.createElement("div",null,h.default.createElement("span",{className:v.default.label},"\u6e90\u8868\uff1a"),h.default.createElement("span",null,n.tableName)),h.default.createElement("div",null,h.default.createElement("span",{className:v.default.label},"\u4e1a\u52a1\u7cfb\u7edf\uff1a"),h.default.createElement("span",null,n.systemName))),h.default.createElement("div",{className:v.default.title},"\u6807\u51c6\u8868\u4fe1\u606f"),h.default.createElement("div",null,h.default.createElement("div",{className:v.default.twoColumns},h.default.createElement("div",null,h.default.createElement("span",{className:v.default.label},"\u6807\u51c6\u8868\uff1a"),h.default.createElement("span",null,h.default.createElement(r.default,{value:a.tableName,onChange:this.changeValue.bind(this,"tableModel.tableName"),disabled:c,style:{width:200}}))),h.default.createElement("div",null,h.default.createElement("span",{className:v.default.label},"\u4e2d\u6587\u540d\uff1a"),h.default.createElement("span",null,h.default.createElement(r.default,{value:a.tableNameCn,onChange:this.changeValue.bind(this,"tableModel.tableNameCn"),disabled:c,style:{width:200}})))),h.default.createElement("div",{className:v.default.twoColumns},h.default.createElement("div",null,h.default.createElement("span",{className:v.default.label},"\u6d41\u6c34\u8868\u6807\u8bc6\uff1a"),h.default.createElement("span",null,h.default.createElement(s.default.Group,{value:a.isLogTable,onChange:this.changeLogTable,disabled:c},h.default.createElement(s.default,{value:"Y"},"\u6d41\u6c34\u8868"),h.default.createElement(s.default,{value:"N"},"\u975e\u6d41\u6c34\u8868")))),h.default.createElement("div",null,h.default.createElement("span",{className:v.default.label},"\u662f\u5426\u589e\u91cf\uff1a"),h.default.createElement("span",null,h.default.createElement(s.default.Group,{value:a.isIncriease,disabled:"Y"===a.isLogTable||c,onChange:this.changeValue.bind(this,"tableModel.isIncriease")},h.default.createElement(s.default,{value:"Y"},"\u589e\u91cf"),h.default.createElement(s.default,{value:"N"},"\u5168\u91cf"))))),h.default.createElement("div",{className:v.default.twoColumns},h.default.createElement("div",null,h.default.createElement("span",{className:v.default.label},"\u8fc7\u6ee4\u6761\u4ef6\uff1a"),h.default.createElement("span",null,h.default.createElement(r.default,{value:u.condition,onChange:this.changeValue.bind(this,"dataIntegrate.condition"),disabled:c,style:{width:200}}))),h.default.createElement("div",null,h.default.createElement("span",{className:v.default.label},"\u96c6\u6210\u7c7b\u578b\uff1a"),h.default.createElement("span",null,h.default.createElement(m.default,{value:u.type,onChange:this.changeValue.bind(this,"dataIntegrate.type"),disabled:c,style:{width:120}},h.default.createElement(y,{value:0},"\u754c\u9762\u914d\u7f6e"),h.default.createElement(y,{value:1},"\u5b58\u50a8\u8fc7\u7a0b"),h.default.createElement(y,{value:2},"sql"))))),2===u.type&&h.default.createElement("div",{style:{marginBottom:"0.6rem"}},h.default.createElement("span",{className:v.default.label},"SQL \u8bed\u53e5\uff1a"),h.default.createElement(I,{rows:5,value:u.config,onChange:this.changeValue.bind(this,"dataIntegrate.config"),disabled:c})),h.default.createElement("div",{className:v.default.twoColumns},h.default.createElement("div",null,h.default.createElement("span",{className:v.default.label},"\u8bf4\u660e\uff1a"),h.default.createElement("span",null,h.default.createElement(r.default,{value:u.remark,onChange:this.changeValue.bind(this,"dataIntegrate.remark"),disabled:c,style:{width:"70%"}}))))))}},u=c))||u),E=g;t.default=E}}]);