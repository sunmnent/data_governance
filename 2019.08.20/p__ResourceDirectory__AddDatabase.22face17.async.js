(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([[42],{Chv6:function(e,t,a){"use strict";var l=a("g09b"),r=a("tAuX");Object.defineProperty(t,"__esModule",{value:!0}),t.default=void 0,a("+L6B");var i=l(a("2/Rp"));a("sRBo");var n=l(a("kaz8"));a("giR+");var u=l(a("fyUT")),d=l(a("2Taf")),s=l(a("vZ4D")),c=l(a("l4Ni")),o=l(a("ujKo")),f=l(a("MhPg"));a("5NDa");var p=l(a("5rEg"));a("7Kak");var m=l(a("9yH6"));a("OaEy");var h=l(a("2fM7"));a("y8nQ");var y,g,v,b=l(a("Vl3Y")),E=r(a("q1tI")),N=a("MuoO"),D=(l(a("Jt6A")),a("7DNP")),I=a("ATFn"),S=l(a("MpEX")),k=b.default.Item,T=h.default.Option,V=m.default.Group,C=p.default.TextArea,F=(y=(0,N.connect)(function(e){var t=e.resourceDirectory,a=e.tagMange,l=e.cachedData;return{resourceDirectory:t,tagMange:a,cachedData:l}}),y((v=function(e){function t(){var e,a;(0,d.default)(this,t);for(var l=arguments.length,r=new Array(l),i=0;i<l;i++)r[i]=arguments[i];return a=(0,c.default)(this,(e=(0,o.default)(t)).call.apply(e,[this].concat(r))),a.handleSubmit=function(e,t){a.props.form.validateFieldsAndScroll(function(l,r){l||(e&&(r.submitState=t),r.isAuth=r.isAuth?1:0,a.props.next(r,e))})},a.blurTableName=function(e){var t=a.props.form,l=t.setFieldsValue,r=t.getFieldValue,i=t.validateFields;if(r("tableName")){var n=r("tableName").toUpperCase();l({tableName:n}),i(["tableName"])}},a.changeFileType=function(e){var t=a.props.form.setFieldsValue;"N"===e&&t({isLogTable:"N",isIncriease:"N"})},a.changeLogTable=function(e){var t=a.props.form.setFieldsValue;t({isIncriease:e.target.value})},a.changeMultiFlag=function(e){var t=a.props.form.setFieldsValue;"M"===e&&t({fileType:"N",isIncriease:"N"})},a.reload=function(){var e=a.props.form,t=e.setFieldsValue,l=e.getFieldValue;setTimeout(function(){"N"===l("fileType")&&t({isIncriease:"N"})},0)},a.goBack=function(){a.props.dispatch(D.routerRedux.goBack())},a.filterOption=function(e,t){return t.props.children.toLowerCase().indexOf(e.toLowerCase())>=0},a}return(0,f.default)(t,e),(0,s.default)(t,[{key:"render",value:function(){var e=this.props.form,t=e.getFieldDecorator,a=e.getFieldValue,l=this.props.resourceDirectory,r=l.fileTypeObj,d=l.multiFlagObj,s=l.resourceTypeObj,c=l.systemList,o=l.secondCatagory,f=this.props.tagMange.tags,y=this.props.value,g=this.props.id&&!(1===y.resourceState&&!y.oldId),v=function(e,t,a){t&&!t.match(I.ENGLISH_CHART)&&a("\u8bf7\u8f93\u5165\u4ee5\u82f1\u6587\u5f00\u5934\u7684\u82f1\u6587\u540d"),a()};return E.default.createElement(b.default,{className:S.default.basicInformation},E.default.createElement(k,{label:"\u8d44\u6e90\u540d\u79f0"},t("tableName",{initialValue:y.tableName,rules:[{required:!0,message:"\u8bf7\u8f93\u5165\u8d44\u6e90\u540d\u79f0"},{max:20,message:"\u6700\u591a20\u4e2a\u5b57\u7b26"},{validator:v}]})(E.default.createElement(p.default,{disabled:g,onBlur:this.blurTableName,placeholder:"\u8bf7\u8f93\u5165\u8d44\u6e90\u540d\u79f0"}))),E.default.createElement(k,{label:"\u4e2d\u6587\u540d\u79f0"},t("tableNameCn",{initialValue:y.tableNameCn,rules:[{required:!0,message:"\u8bf7\u8f93\u5165\u4e2d\u6587\u540d\u79f0"}]})(E.default.createElement(p.default,{placeholder:"\u8bf7\u8f93\u5165\u4e2d\u6587\u540d\u79f0"}))),E.default.createElement(k,{label:"\u5f62\u6001"},t("resourceType",{initialValue:y.resourceType||"D",rules:[{required:!0,message:"\u8bf7\u9009\u62e9\u5f62\u6001"}]})(E.default.createElement(h.default,{disabled:g,placeholder:"\u8bf7\u9009\u62e9\u5f62\u6001",onChange:this.reload},Object.entries(s).map(function(e){return E.default.createElement(T,{value:e[1],key:e[0]},e[0])})))),E.default.createElement(k,{label:"\u6e90\u7cfb\u7edf"},t("busSystemId",{initialValue:y.busSystemId||c[0]&&c[0].id,rules:[{required:!0,message:"\u8bf7\u9009\u62e9\u6e90\u7cfb\u7edf"}]})(E.default.createElement(h.default,{disabled:g,placeholder:"\u8bf7\u9009\u62e9\u6e90\u7cfb\u7edf",showSearch:!0,optionFilterProp:"children"},c.map(function(e){return E.default.createElement(T,{value:e.id,key:e.id},e.name)})))),E.default.createElement(k,{label:"\u4e3b\u9898"},t("classifyId",{initialValue:y.classifyId,rules:[{required:!0,message:"\u8bf7\u9009\u62e9\u4e3b\u9898"}]})(E.default.createElement(h.default,{placeholder:"\u8bf7\u9009\u62e9\u4e3b\u9898"},o.map(function(e){return E.default.createElement(T,{value:e.id,key:e.id},e.name)})))),E.default.createElement(k,{label:"\u6d41\u6c34\u8868\u6807\u8bc6"},t("isLogTable",{initialValue:y.isLogTable||"N",rules:[{required:!0,message:"\u8bf7\u9009\u62e9\u6d41\u6c34\u8868\u6807\u8bc6"}]})(E.default.createElement(V,{disabled:"F"===a("resourceType")&&"S"!==a("fileType"),onChange:this.changeLogTable},E.default.createElement(m.default,{value:"Y"},"\u6d41\u6c34\u8868"),E.default.createElement(m.default,{value:"N"},"\u975e\u6d41\u6c34\u8868")))),E.default.createElement(k,{label:"\u662f\u5426\u589e\u91cf"},t("isIncriease",{initialValue:y.isIncriease||"N",rules:[{required:!0,message:"\u8bf7\u9009\u62e9\u662f\u5426\u589e\u91cf"}]})(E.default.createElement(V,{disabled:"Y"===a("isLogTable")||"N"===a("fileType")},E.default.createElement(m.default,{value:"Y"},"\u589e\u91cf"),E.default.createElement(m.default,{value:"N"},"\u5168\u91cf")))),"Y"===a("isIncriease")&&E.default.createElement(E.Fragment,null,E.default.createElement(k,{label:"\u589e\u91cf\u6761\u4ef6"},t("increaseParam",{initialValue:y.increaseParam})(E.default.createElement(p.default,{placeholder:"\u8bf7\u8f93\u5165\u589e\u91cf\u6761\u4ef6"}))),E.default.createElement(k,{label:"\u589e\u91cf\u521d\u59cb\u503c"},t("increaseInitValue",{initialValue:y.increaseInitValue})(E.default.createElement(u.default,{placeholder:"\u8bf7\u8f93\u5165\u589e\u91cf\u521d\u59cb\u503c"})))),"F"===a("resourceType")&&E.default.createElement("div",null,E.default.createElement(k,{label:"\u590d\u5408\u8d44\u6e90\u6807\u8bc6"},t("multiFlag",{initialValue:y.multiFlag||"M",rules:[{required:!0,message:"\u8bf7\u9009\u62e9\u590d\u5408\u8d44\u6e90\u6807\u8bc6"}]})(E.default.createElement(h.default,{disabled:g,placeholder:"\u8bf7\u9009\u62e9\u590d\u5408\u8d44\u6e90\u6807\u8bc6",onChange:this.changeMultiFlag},Object.entries(d).map(function(e){return E.default.createElement(T,{value:e[1],key:e[0]},e[0])})))),E.default.createElement(k,{label:"\u6587\u4ef6\u7c7b\u578b"},t("fileType",{initialValue:y.fileType||"N",rules:[{required:!0,message:"\u8bf7\u9009\u62e9\u6587\u4ef6\u7c7b\u578b"}]})(E.default.createElement(h.default,{placeholder:"\u8bf7\u9009\u62e9\u6587\u4ef6\u7c7b\u578b",disabled:"M"===a("multiFlag")||g,onChange:this.changeFileType},Object.entries(r).map(function(e){return E.default.createElement(T,{value:e[1],key:e[0]},e[0])}))))),E.default.createElement(k,{label:"\u6807\u7b7e"},t("tagIds",{initialValue:y.tagList&&y.tagList.map(function(e){return e.id})})(E.default.createElement(h.default,{mode:"multiple",placeholder:"\u8bf7\u9009\u62e9\u6807\u7b7e",filterOption:this.filterOption},f.map(function(e){return E.default.createElement(T,{value:e.id,key:e.id},e.tagName)})))),E.default.createElement(k,{label:"\u8d44\u6e90\u63cf\u8ff0"},t("tableDesc",{initialValue:y.tableDesc})(E.default.createElement(C,{rows:4,placeholder:"\u8bf7\u8f93\u5165\u8d44\u6e90\u63cf\u8ff0"}))),E.default.createElement(k,{label:" ",colon:!1},t("isAuth",{valuePropName:"checked",initialValue:y.isAuth})(E.default.createElement(n.default,{disabled:g},"\u662f\u5426\u6709\u6761\u4ef6\u5171\u4eab\uff08\u6b64\u8d44\u6e90\u9700\u8981\u901a\u8fc7\u63d0\u4f9b\u65b9\u5ba1\u6838\uff0c\u4f7f\u7528\u65b9\u65b9\u53ef\u4f7f\u7528\uff09"))),E.default.createElement(k,null,E.default.createElement("div",{className:S.default.action},E.default.createElement(i.default,{onClick:this.goBack,className:S.default.marginRight},"\u53d6\u6d88"),"N"===a("fileType")?E.default.createElement("span",null,E.default.createElement(i.default,{type:"primary",onClick:this.handleSubmit.bind(this,!0,1),className:S.default.marginRight},"\u4fdd\u5b58"),E.default.createElement(i.default,{type:"primary",onClick:this.handleSubmit.bind(this,!0,2)},"\u63d0\u4ea4")):E.default.createElement(i.default,{type:"primary",onClick:this.handleSubmit.bind(this,!1)},"\u4e0b\u4e00\u6b65"))))}}]),t}(E.Component),g=v))||g),O=b.default.create()(F);t.default=O},O043:function(e,t,a){"use strict";var l=a("g09b"),r=a("tAuX");Object.defineProperty(t,"__esModule",{value:!0}),t.default=void 0,a("T2oS");var i=l(a("W9HT")),n=l(a("Y/ft")),u=l(a("eHn4")),d=l(a("p0pE")),s=l(a("2Taf")),c=l(a("vZ4D")),o=l(a("l4Ni")),f=l(a("ujKo")),p=l(a("MhPg"));a("FJo9");var m,h,y,g=l(a("L41K")),v=r(a("q1tI")),b=a("MuoO"),E=l(a("Qyje")),N=l(a("Chv6")),D=l(a("X2kM")),I=l(a("MpEX")),S=g.default.Step,k=(m=(0,b.connect)(function(e){var t=e.resourceDirectory,a=e.cachedData,l=e.tagMange,r=e.sunmStandard,i=e.loading;return{resourceDirectory:t,cachedData:a,tagMange:l,sunmStandard:r,loading:i}}),m((y=function(e){function t(){var e,a;(0,s.default)(this,t);for(var l=arguments.length,r=new Array(l),i=0;i<l;i++)r[i]=arguments[i];return a=(0,o.default)(this,(e=(0,f.default)(t)).call.apply(e,[this].concat(r))),a.state={current:0,value:{}},a.next=function(e,t){var l=a.state,r=l.value,i=l.current,s=a.props.resourceDirectory,c=s.idItem,o=(s.systemList,E.default.parse(a.props.location.search.slice(1))),f=o.id,p=(0,d.default)({},r,(0,u.default)({},i,e));if(p[1]=p[1]||{},p[1].items=p[1].items||[],0!==i||t){var m=E.default.parse(a.props.location.search.slice(1)),h=m.id,y=p[1].items.map(function(e){if(!e.isOld){e.id;var t=(0,n.default)(e,["id"]);return t}return e});h&&(y=y.filter(function(e){return 3!==e.status})),a.props.dispatch({type:"resourceDirectory/saveResource",payload:(0,d.default)({id:h},p[0],p[1],{items:y})})}else f||a.added||(c.forEach(function(e){p[1].items.find(function(t){return t.dataItemId===e.id})||(p[1].items.find(function(e){return e.isPk})||(e.isPk=!0,e.isNullAble="N"),p[1].items.unshift(e))}),a.added=!0),a.setState({current:i+1,value:p})},a.prev=function(e){var t=a.state,l=t.value,r=t.current;a.setState({value:(0,d.default)({},l,(0,u.default)({},r,e)),current:r-1})},a}return(0,p.default)(t,e),(0,c.default)(t,[{key:"componentDidMount",value:function(){var e=this,t=this.props.resourceDirectory,a=t.fileTypeObj,l=t.multiFlagObj,r=t.resourceTypeObj,i=t.systemList,n=t.encyptList,u=t.idItem,d=t.secondCatagory,s=this.props.cachedData.dataItemCatagory;Object.keys(a).length||this.props.dispatch({type:"resourceDirectory/getFileTypeObj"}),Object.keys(l).length||this.props.dispatch({type:"resourceDirectory/getMultiFlagObj"}),Object.keys(r).length||this.props.dispatch({type:"resourceDirectory/getResourceTypeObj"}),Object.keys(n).length||this.props.dispatch({type:"resourceDirectory/getEncyptList"}),i.length||this.props.dispatch({type:"resourceDirectory/getSystemList"}),d.length||this.props.dispatch({type:"resourceDirectory/queurySecondCatagory"}),s.length||this.props.dispatch({type:"cachedData/getDataItemCatagory"}),u.length||this.props.dispatch({type:"resourceDirectory/getIDItem"}),this.props.tagMange.tags.length||this.props.dispatch({type:"tagMange/getAllTag"});var c=E.default.parse(this.props.location.search.slice(1)),o=c.id;o&&Promise.all([this.props.dispatch({type:"resourceDirectory/getResourceDetail",payload:o}),this.props.dispatch({type:"resourceDirectory/getDataItems",payload:{id:o}})]).then(function(t){t[1]&&t[1].forEach(function(e){e.isOld=!0}),e.setState({value:{0:t[0],1:{items:t[1],fileUrl:t[0].fileUrl,fileName:t[0].fileName}}})});var f=this.props.sunmStandard.fieldType;f.length||this.props.dispatch({type:"sunmStandard/fetchFieldType"})}},{key:"render",value:function(){var e=this.state,t=e.current,a=e.value,l=E.default.parse(this.props.location.search.slice(1)),r=l.id,n=l.type,u=l.saveBtn,d=!0===this.props.loading.effects["resourceDirectory/getResourceDetail"],s=[{title:"\u57fa\u672c\u4fe1\u606f",content:v.default.createElement(N.default,{next:this.next,value:a["0"]||{},id:r})},{title:"\u6570\u636e\u7ed3\u6784",content:v.default.createElement(D.default,{prev:this.prev,next:this.next,value:a["1"]||{},id:r,type:n,saveBtn:u})}];return v.default.createElement(i.default,{spinning:d},v.default.createElement("h1",{className:I.default.title},r?"\u7f16\u8f91":"\u65b0\u5efa","\u8d44\u6e90"),v.default.createElement(g.default,{current:t,className:I.default.steps},s.map(function(e){return v.default.createElement(S,{key:e.title,title:e.title})})),v.default.createElement("div",null,s[t].content))}}]),t}(v.Component),h=y))||h),T=k;t.default=T},X2kM:function(e,t,a){"use strict";var l=a("g09b"),r=a("tAuX");Object.defineProperty(t,"__esModule",{value:!0}),t.default=void 0,a("DZo9");var i=l(a("8z0m"));a("g9YV");var n=l(a("wCAj"));a("+L6B");var u=l(a("2/Rp")),d=l(a("gWZ8"));a("miYZ");var s=l(a("tsqr")),c=l(a("eHn4"));a("P2fV");var o=l(a("NJEC"));a("Pwec");var f=l(a("CtXQ"));a("giR+");var p=l(a("fyUT"));a("5NDa");var m=l(a("5rEg")),h=l(a("2Taf")),y=l(a("vZ4D")),g=l(a("l4Ni")),v=l(a("ujKo")),b=l(a("rlhR")),E=l(a("MhPg"));a("y8nQ");var N=l(a("Vl3Y"));a("OaEy");var D,I,S,k=l(a("2fM7")),T=r(a("q1tI")),V=a("MuoO"),C=l(a("LvDl")),F=a("7DNP"),O=a("Wvwx"),M=l(a("RSsB")),x=a("qxfp"),j=l(a("MpEX")),A=k.default.Option,L=N.default.Item,R={},w=function(e,t,a){t&&t.match(/[\u4e00-\u9fa5]/)?a("\u6570\u636e\u9879\u540d\u4e0d\u80fd\u542b\u6709\u4e2d\u6587"):!t||isNaN(parseInt(t[0]))?a():a("\u6570\u636e\u9879\u540d\u4e0d\u80fd\u4ee5\u6570\u5b57\u5f00\u5934")},q=(D=(0,V.connect)(function(e){var t=e.resourceDirectory,a=e.sunmStandard;return{resourceDirectory:t,sunmStandard:a}}),D((S=function(e){function t(){var e,a;(0,h.default)(this,t);for(var l=arguments.length,r=new Array(l),i=0;i<l;i++)r[i]=arguments[i];return a=(0,g.default)(this,(e=(0,v.default)(t)).call.apply(e,[this].concat(r))),a.state={data:a.props.value.items||[],fileUrl:a.props.value.fileUrl,fileName:a.props.value.fileName,modalVisible:!1},a.renderInput2=function(e,t,l,r){var i=a.props.form,n=i.getFieldDecorator,u=i.getFieldValue,d=a.isDisabled(l);if(3===l.dataItemState)return t;if("chineseName"===e)return T.default.createElement(L,null,n("".concat(e,"-").concat(l.id),{initialValue:t,rules:[{required:!0,message:"\u8bf7\u8f93\u5165"}]})(T.default.createElement(m.default,{disabled:d,onChange:a.changeChineseName.bind((0,b.default)(a),l)})));if("dataItemName"===e)return T.default.createElement(L,null,n("".concat(e,"-").concat(l.id),{initialValue:t,rules:[{required:!0,message:"\u8bf7\u8f93\u5165"},{validator:w}]})(T.default.createElement(m.default,{disabled:d})));if("dataTypeName"===e){e="dataType";var s=a.props.sunmStandard.fieldType;return T.default.createElement(L,null,n("".concat(e,"-").concat(l.id),{initialValue:l.dataType,rules:[{required:!0,message:"\u8bf7\u9009\u62e9"}]})(T.default.createElement(k.default,{disabled:d,style:{width:90},onChange:a.changeDataType.bind((0,b.default)(a),l)},s.map(function(e){return T.default.createElement(A,{value:e.value,key:e.value},e.title)}))))}if("length"===e){var c=u("dataType-".concat(l.id)),o="DATETIME"===u("dataType-".concat(l.id)),f=["VARCHAR","DOUBLE","DECIMAL"].includes(c);return T.default.createElement(L,null,n("".concat(e,"-").concat(l.id),{initialValue:t,rules:[{required:f,message:"\u8bf7\u8f93\u5165"}]})(T.default.createElement(p.default,{disabled:d||o,min:1,max:4e3,style:{width:55}})))}if("percision"===e){var h=u("dataType-".concat(l.id)),y="DOUBLE"===h||"DECIMAL"===h;return T.default.createElement(L,null,n("".concat(e,"-").concat(l.id),{initialValue:t,rules:[{required:y,message:"\u8bf7\u8f93\u5165"}]})(T.default.createElement(p.default,{disabled:!y,min:0,max:255,style:{width:55}})))}return"remark"===e?T.default.createElement(L,null,n("".concat(e,"-").concat(l.id),{initialValue:t})(T.default.createElement(m.default,{disabled:d}))):T.default.createElement(L,null,n("".concat(e,"-").concat(l.id),{initialValue:t,rules:[{required:!0,message:"\u8bf7\u8f93\u5165"}]})(T.default.createElement(m.default,{disabled:d})))},a.renderSelect=function(e,t,l,r){var i=a.props.form,n=i.getFieldDecorator,u=i.getFieldValue,d=a.isDisabled(l);if("isNullAble"===e){var s=u("isPk-".concat(l.id));return T.default.createElement(L,null,n("".concat(e,"-").concat(l.id),{initialValue:t||"Y",rules:[{required:!0,message:"\u8bf7\u9009\u62e9"}]})(T.default.createElement(k.default,{disabled:s||d},T.default.createElement(A,{value:"Y"},"\u662f"),T.default.createElement(A,{value:"N"},"\u5426"))))}if("isPk"===e)return T.default.createElement(L,null,n("".concat(e,"-").concat(l.id),{initialValue:t||!1,rules:[{required:!0,message:"\u8bf7\u9009\u62e9"}]})(T.default.createElement(k.default,{disabled:d,onChange:a.changePk.bind((0,b.default)(a),l)},T.default.createElement(A,{value:!0},"\u662f"),T.default.createElement(A,{value:!1},"\u5426"))));if("isEncypt"===e){var c=a.props.resourceDirectory.encyptList;return T.default.createElement(L,null,n("".concat(e,"-").concat(l.id),{initialValue:t||1,rules:[{required:!0,message:"\u8bf7\u9009\u62e9"}]})(T.default.createElement(k.default,{disabled:d},Object.entries(c).map(function(e){return T.default.createElement(A,{value:e[1],key:e[1]},e[0])}))))}},a.columns=function(){var e=[{title:"\u4e2d\u6587\u7b80\u79f0",dataIndex:"chineseName",render:a.renderInput2.bind((0,b.default)(a),"chineseName")},{title:"\u6570\u636e\u9879\u540d",dataIndex:"dataItemName",render:a.renderInput2.bind((0,b.default)(a),"dataItemName")},{title:"\u7c7b\u578b",dataIndex:"dataTypeName",render:a.renderInput2.bind((0,b.default)(a),"dataTypeName")},{title:"\u957f\u5ea6",dataIndex:"length",render:a.renderInput2.bind((0,b.default)(a),"length")},{title:"\u7cbe\u5ea6",dataIndex:"percision",render:a.renderInput2.bind((0,b.default)(a),"percision")},{title:"\u662f\u5426\u4e3a\u7a7a",dataIndex:"isNullAble",render:a.renderSelect.bind((0,b.default)(a),"isNullAble")},{title:"\u662f\u5426\u4e3b\u952e",dataIndex:"isPk",render:a.renderSelect.bind((0,b.default)(a),"isPk")},{title:"\u5b89\u5168\u9009\u9879",dataIndex:"isEncypt",render:a.renderSelect.bind((0,b.default)(a),"isEncypt")},{title:"\u4e1a\u52a1\u5b9a\u4e49\u53ca\u89c4\u5219",dataIndex:"businessDefinition",render:a.renderInput2.bind((0,b.default)(a),"businessDefinition")},{title:"\u64cd\u4f5c",dataIndex:"operation",render:function(e,t,l){var r=a.isDisabled(t);if(!r)return T.default.createElement(o.default,{title:"\u786e\u5b9a\u5220\u9664\uff1f",onConfirm:a.delete.bind((0,b.default)(a),t,l)},T.default.createElement(f.default,{type:"delete",className:"can-click",title:"\u5220\u9664"}))}}];"1"===a.props.type?e.splice(11,0,{title:"\u4fee\u6539\u5907\u6ce8",dataIndex:"remark"}):"2"===a.props.type&&e.splice(11,0,{title:"\u4fee\u6539\u5907\u6ce8",dataIndex:"remark",render:a.renderInput2.bind((0,b.default)(a),"remark")},{title:"\u4fee\u6539\u72b6\u6001",dataIndex:"operationState",render:function(e){return 0===e?"\u5220\u9664":1===e?"\u65b0\u589e":2===e?"\u4fee\u6539":void 0}});var t=a.props.id;return t&&e.unshift({title:"",dataIndex:"status",render:function(e){return T.default.createElement("span",null,1===e&&T.default.createElement(f.default,{type:"plus"}),2===e&&T.default.createElement(f.default,{type:"edit"}),3===e&&T.default.createElement(f.default,{type:"minus"}))}}),e}(),a.isDisabled=function(e){return a.props.id&&3===e.status},a.delete=function(e,t){if("1"===a.props.type&&e.dataItemId)void 0===R[e.id]&&(R[e.id]=0,document.querySelectorAll(".ant-table-tbody tr")[t].classList.add(j.default.delete));else{var l=a.state.data.filter(function(t){return t.id!==e.id});a.setState({data:l})}},a.changeChineseName=function(e,t){a.props.form.setFieldsValue((0,c.default)({},"dataItemName-".concat(e.id),(0,O.getChart)(t.target.value.trim())))},a.changeDataType=function(e){a.props.form.setFieldsValue((0,c.default)({},"percision-".concat(e.id),void 0))},a.changePk=function(e,t){t&&a.props.form.setFieldsValue((0,c.default)({},"isNullAble-".concat(e.id),"N"))},a.handleSubmit=function(e,t){a.props.form.validateFields(function(l,r){if(!l){var i=C.default.cloneDeep(a.state.data);Object.entries(r).map(function(e){var t=e[0].split("-");if(2===t.length){var a=t[0],l=t[1],r=i.findIndex(function(e){return String(e.id)===l});-1!==r&&(i[r][a]=e[1])}});var n=!0,u=!1,d=void 0;try{for(var c,o=i[Symbol.iterator]();!(n=(c=o.next()).done);n=!0){var f=c.value;if(3!==f.dataItemState&&!f.businessDefinition)return void s.default.warn("\u8bf7\u586b\u5199\u4e1a\u52a1\u5b9a\u4e49\u53ca\u89c4\u5219")}}catch(l){u=!0,d=l}finally{try{n||null==o.return||o.return()}finally{if(u)throw d}}"1"===a.props.type?Object.entries(R).forEach(function(e){var t=i.find(function(t){return String(t.id)===e[0]});t&&(t.operationState=e[1])}):"2"===a.props.type&&(i=i.filter(function(e){return 0!==e.operationState}),i.forEach(function(e){e.remark=null,e.operationState=null})),e({fileUrl:a.state.fileUrl,fileName:a.state.fileName,items:i,submitState:t})}})},a.showModal=function(){a.setState({modalVisible:!0})},a.hideModal=function(){a.setState({modalVisible:!1})},a.addData=function(e){a.setState({data:[].concat((0,d.default)(a.state.data),(0,d.default)(e))}),"1"===a.props.type&&e.forEach(function(e){R[e.id]=1})},a.add=function(){var e=Date.now();a.addData([{id:e,dataItemState:0}])},a.goBack=function(){a.props.dispatch(F.routerRedux.goBack())},a}return(0,E.default)(t,e),(0,y.default)(t,[{key:"render",value:function(){var e=this,t=this.state,a=t.modalVisible,l=t.data,r=t.fileUrl,d=t.fileName,c=this.props.form.getFieldDecorator,o=this.props,p=o.id,m=o.type,h=o.saveBtn,y="".concat(x.BASE_URL,"/tableModelResource/uploadFile?token=").concat((0,x.TOKEN)());p&&(y+="&resourceId=".concat(p));var g={name:"file",action:y,onRemove:function(t){e.setState({fileUrl:"",fileName:""})},beforeUpload:function(t){var a=new FormData;return a.append("file",t),fetch(y,{method:"POST",body:a}).then(function(e){return e.json()}).then(function(t){t.success?(e.setState({fileUrl:t.obj.fileUrl,fileName:t.obj.fileName}),s.default.success("\u6587\u4ef6\u4e0a\u4f20\u6210\u529f")):s.default.error(t.msg)}),!1},fileList:d?[{uid:"1",name:d,status:"done",url:"".concat(x.BASE_URL,"/tableModelResource/downloadFile?token=").concat((0,x.TOKEN)(),"&fileName=").concat(d,"&fileUrl=").concat(r)}]:[]};return T.default.createElement("div",{className:j.default.tableStructure},T.default.createElement(u.default,{type:"primary",onClick:this.showModal,className:j.default.marginRight},T.default.createElement(f.default,{type:"plus"}),"\u9009\u62e9"),T.default.createElement(u.default,{type:"primary",onClick:this.add},T.default.createElement(f.default,{type:"plus"}),"\u65b0\u589e"),T.default.createElement(N.default,{layout:"inline"},T.default.createElement(n.default,{bordered:!0,dataSource:this.state.data,columns:this.columns,pagination:!1,className:j.default.table,rowKey:"id"}),T.default.createElement(L,{label:"\u9644\u4ef6\u8bc1\u660e",extra:"10\u6761\u4ee5\u4e0a\u6570\u636e\u6837\u4f8b\u6216\u6570\u636e\u5e93\u5b57\u6bb5\u8bf4\u660e\u6587\u4ef6..."},c("fileUrl",{})(T.default.createElement(i.default,g,T.default.createElement(u.default,null,T.default.createElement(f.default,{type:"upload"})," \u4e0a\u4f20\u6587\u4ef6"))))),T.default.createElement("div",{className:j.default.action},T.default.createElement(u.default,{onClick:this.goBack,className:j.default.marginRight},"\u53d6\u6d88"),T.default.createElement(u.default,{onClick:this.handleSubmit.bind(this,this.props.prev),className:j.default.marginRight},"\u4e0a\u4e00\u6b65"),"1"===m?T.default.createElement(u.default,{type:"primary",onClick:this.handleSubmit.bind(this,this.props.next,1),className:j.default.marginRight},"\u4fdd\u5b58\u5e76\u9a73\u56de"):T.default.createElement(T.Fragment,null,"0"!==h&&T.default.createElement(u.default,{type:"primary",onClick:this.handleSubmit.bind(this,this.props.next,1),className:j.default.marginRight},"\u4fdd\u5b58"),T.default.createElement(u.default,{type:"primary",onClick:this.handleSubmit.bind(this,this.props.next,2)},"\u63d0\u4ea4"))),T.default.createElement(M.default,{addData:this.addData,existData:l,modalVisible:a,hideModal:this.hideModal}))}}]),t}(T.default.Component),I=S))||I),P=N.default.create({onValuesChange:function(e,t,a){if("1"===e.type){var l=Object.entries(t)[0][0].split("-")[1];void 0===R[l]&&(R[l]=2)}}})(q);t.default=P}}]);