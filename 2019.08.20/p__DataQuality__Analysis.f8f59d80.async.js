(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([[13],{"/HqL":function(e,t,a){e.exports={all:"all___-yyh-",flex:"flex___ExNjL",tree:"tree___1ObeX",right:"right___1JT8J",form:"form___2oQpP"}},mjdS:function(e,t,a){"use strict";var l=a("g09b"),i=a("tAuX");Object.defineProperty(t,"__esModule",{value:!0}),t.default=void 0,a("2qtc");var n=l(a("kLXV"));a("g9YV");var r=l(a("wCAj"));a("+L6B");var d=l(a("2/Rp"));a("5NDa");var o=l(a("5rEg"));a("T2oS");var c=l(a("W9HT"));a("ozfa");var u=l(a("MJZm")),s=l(a("p0pE"));a("Pwec");var p=l(a("CtXQ")),f=l(a("2Taf")),m=l(a("vZ4D")),y=l(a("l4Ni")),h=l(a("ujKo")),g=l(a("rlhR")),b=l(a("MhPg"));a("iQDF");var v=l(a("+eQT"));a("y8nQ");var k,S,x,T=l(a("Vl3Y")),E=i(a("q1tI")),Q=a("MuoO"),w=a("7DNP"),N=l(a("cVA7")),I=l(a("MT78")),C=l(a("LvDl")),D=l(a("Qyje")),L=l(a("eJJh")),R=a("Jur2"),_=l(a("/HqL")),A=T.default.Item,q=v.default.RangePicker,V=10,P=(k=(0,Q.connect)(function(e){var t=e.dataQuality,a=e.loading;return{dataQuality:t,loading:a}}),k((x=function(e){function t(){var e,a;(0,f.default)(this,t);for(var l=arguments.length,i=new Array(l),n=0;n<l;n++)i[n]=arguments[n];return a=(0,y.default)(this,(e=(0,h.default)(t)).call.apply(e,[this].concat(i))),a.state={modalData:{},analysisModal:{}},a.columns=[{title:"\u8868\u540d",width:"20%",dataIndex:"tableChineseName",sorter:!0,render:function(e,t){return E.default.createElement("span",{onClick:a.clickTableName.bind((0,g.default)(a),t),className:"can-click"},e)}},{title:"\u5b57\u6bb5\u603b\u6570",width:"15%",dataIndex:"dataItemSize"},{title:"\u68c0\u6838\u5b57\u6bb5\u6570",width:"15%",dataIndex:"checkDataItemSize"},{title:"\u68c0\u6838\u65e5\u671f",width:"20%",dataIndex:"checkTime",key:"checkTime"},{title:"\u95ee\u9898\u7387",width:"20%",dataIndex:"problemRatio",render:function(e){return E.default.createElement("span",null,null!==e?"".concat(e,"%"):"")}},{title:"\u8d8b\u52bf",width:"10%",render:function(e,t){return E.default.createElement(p.default,{onClick:a.clickTrend.bind((0,g.default)(a),t),type:"area-chart",className:"can-click",title:"\u8d8b\u52bf"})}},{title:"\u5206\u6790",width:"10%",render:function(e,t){return E.default.createElement(p.default,{onClick:a.clickAnalysis.bind((0,g.default)(a),t),type:"dashboard",className:"can-click",title:"\u5206\u6790"})}}],a.clickTableName=function(e){a.props.dispatch(w.routerRedux.push("/dataquality/dataqualityanalysis?checkTable=".concat(e.tableId)))},a.clickAnalysis=function(e){a.setState({analysisModal:e})},a.cancelAnalysisModal=function(){a.setState({analysisModal:{}})},a.handleTableChange=function(e,t,l){var i=l.field?C.default.snakeCase(l.field):"",n="";"descend"===l.order?n="desc":"ascend"===l.order&&(n="asc");var r=a.props.dataQuality.qualityReportList.params,d=void 0===r?{}:r,o=(0,s.default)({},d,{pageParam:{pageSize:V,pageNum:e.current}});i.length&&(o.orderColumn=i),n.length&&(o.orderBy=n),a.props.dispatch({type:"dataQuality/getQualityReport",payload:o})},a.handleSubmit=function(e){e.preventDefault(),a.props.form.validateFields(function(e,t){if(!e){t.checkTime&&(t.checkTimeStart=t.checkTime[0],t.checkTimeEnd=t.checkTime[1],delete t.checkTime);var l=a.props.dataQuality.qualityReportList.params,i=void 0===l?{}:l;a.props.dispatch({type:"dataQuality/getQualityReport",payload:(0,s.default)({},i,t,{pageParam:{pageNum:1,pageSize:V}})})}})},a.onSelect=function(e,t){var l=a.props.dataQuality.qualityReportList.params,i=void 0===l?{}:l;a.props.dispatch({type:"dataQuality/getQualityReport",payload:(0,s.default)({},i,{pageParam:{pageNum:1,pageSize:V},systemId:e[0]})})},a.clickTrend=function(e){a.setState({modalData:e}),a.props.dispatch({type:"dataQuality/getQualityReportTrend",payload:{tableId:e.tableId}})},a.modalClose=function(){a.setState({modalData:{}})},a.chartOption=function(){var e=a.props.dataQuality.qualityReportTrend,t=void 0===e?[]:e,l=[],i=[];t.forEach(function(e){l.push(e.checkTime),i.push(e.problemTotalRatio)});var n={tooltip:{trigger:"axis",axisPointer:{lineStyle:{color:"#ddd"}},backgroundColor:"rgba(255,255,255,1)",padding:[5,10],textStyle:{color:"#7588E4"},extraCssText:"box-shadow: 0 0 5px rgba(0,0,0,0.3)"},legend:{right:20,orient:"vertical"},xAxis:{type:"category",data:l,boundaryGap:!1,splitLine:{show:!0,interval:"auto",lineStyle:{color:["#eee"]}},axisTick:{show:!1},axisLine:{lineStyle:{color:"#ccc"}},axisLabel:{margin:10,textStyle:{fontSize:12,color:"#777"}}},yAxis:{name:"\u95ee\u9898\u7387%",type:"value",splitLine:{lineStyle:{color:["#eee"]}},axisTick:{show:!1},axisLine:{lineStyle:{color:"#ccc"}},axisLabel:{margin:5,textStyle:{fontSize:14,color:"#777"}}},series:[{name:"\u95ee\u9898\u7387",type:"line",smooth:!0,showSymbol:!1,symbol:"circle",symbolSize:6,data:i,areaStyle:{normal:{color:new I.default.graphic.LinearGradient(0,0,0,1,[{offset:0,color:"rgba(189, 224, 253, 1)"},{offset:1,color:"rgba(189, 224, 253, 1)"}],!1)}},itemStyle:{normal:{color:"#2e9afe"}},lineStyle:{normal:{width:3}}}]};return t.length>5&&(n.dataZoom=[{type:"slider",xAxisIndex:[0],startValue:0,endValue:5},{type:"inside",xAxisIndex:[0],startValue:0,endValue:5}]),n},a.getDefaultValue=function(e,t){if(void 0===e){var l=a.props.dataQuality.qualityReportList.params,i=void 0===l?{}:l;return"checkTime"===t?[i.checkTimeStart,i.checkTimeEnd]:i[t]}},a}return(0,b.default)(t,e),(0,m.default)(t,[{key:"componentDidMount",value:function(){this.props.dispatch({type:"dataQuality/querySystemByUserIdAndDept"});var e=D.default.parse(this.props.location.search,{ignoreQueryPrefix:!0}),t=e.id;this.props.dispatch({type:"dataQuality/getQualityReport",payload:{pageParam:{pageNum:1,pageSize:V},systemId:t}})}},{key:"render",value:function(){var e=this.props.form.getFieldDecorator,t=this.props.dataQuality,a=t.qualityReportList,l=t.systems,i=a.list,s=void 0===i?[]:i,p=this.state,f=p.analysisModal,m=p.modalData,y=D.default.parse(this.props.location.search,{ignoreQueryPrefix:!0}),h=y.id;return E.default.createElement("div",{className:_.default.all},E.default.createElement("div",{className:_.default.flex},E.default.createElement(c.default,{spinning:this.props.loading.effects["dataQuality/querySystemByUserIdAndDept"]},l.length&&E.default.createElement(u.default,{onSelect:this.onSelect,className:_.default.tree,defaultSelectedKeys:[h||this.getDefaultValue(h,"systemId")],defaultExpandAll:!0},(0,R.generateCheckTableName)(l,2))),E.default.createElement("div",{className:_.default.right},E.default.createElement(T.default,{layout:"inline",onSubmit:this.handleSubmit,className:_.default.form},E.default.createElement(A,{label:"\u8868\u540d"},e("tableName",{initialValue:this.getDefaultValue(h,"tableName")})(E.default.createElement(o.default,{placeholder:"\u8bf7\u8f93\u5165\u8868\u540d",style:{width:150}}))),E.default.createElement(A,{label:"\u68c0\u6838\u65e5\u671f"},e("checkTime",{initialValue:this.getDefaultValue(h,"checkTime")})(E.default.createElement(q,{style:{width:250}}))),E.default.createElement(A,null,E.default.createElement(d.default,{type:"primary",htmlType:"submit"},"\u641c\u7d22"))),E.default.createElement(r.default,{onChange:this.handleTableChange,rowKey:"tableId",columns:this.columns,dataSource:s,loading:this.props.loading.effects["dataQuality/getQualityReport"],pagination:{current:a.pageNum,total:a.total}}))),E.default.createElement(n.default,{title:"\u8d8b\u52bf\u5206\u6790",visible:void 0!==m.tableId,onCancel:this.modalClose,footer:null,width:760},E.default.createElement("div",{style:{display:"flex",justifyContent:"space-between",marginBottom:20}},E.default.createElement("div",null,"\u8868\u540d\uff1a",m.tableChineseName),E.default.createElement("div",null,"\u5b57\u6bb5\u603b\u6570\uff1a",m.dataItemSize),E.default.createElement("div",null,"\u68c0\u6838\u5b57\u6bb5\u6570\uff1a",m.checkDataItemSize)),E.default.createElement(N.default,{option:this.chartOption(),style:{height:"300px"}})),E.default.createElement(n.default,{title:"\u5206\u6790",visible:void 0!==f.tableId,onCancel:this.cancelAnalysisModal,footer:null,width:1e3},f.tableId&&E.default.createElement(L.default,{tableName:f.tableName,tableNameCN:f.tableChineseName,datasourceId:f.tableId,type:2,height:300})))}}]),t}(E.Component),S=x))||S),z=T.default.create()(P);t.default=z}}]);